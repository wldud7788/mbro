<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++
@@ 주문/배송 상세 @@
- 파일위치 : [스킨폴더]/mypage/order_view.html
++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

{? pgCompany == "lg"}<script type="text/javascript" src="//pgweb.uplus.co.kr/WEB_SERVER/js/receipt_link.js"></script>{/}
{? pgCompany == "allat"} {/}

<div class="subpage_wrap">

	<!-- +++++ mypage LNB ++++ -->
	<div id="subpageLNB" class="subpage_lnb"><!-- [스킨폴더]/mypage/mypage_lnb.html --></div>
	<!-- +++++ //mypage LNB ++++ -->

	<!-- +++++ mypage contents ++++ -->
	<div class="subpage_container">
		<!-- 전체 메뉴 -->
		<a id="subAllButton" class="btn_sub_all" href="javascript:void(0)">MENU</a>

		<!-- 타이틀 -->
		<div class="title_container">
			<h2><span designElement="text">주문/배송 상세</span></h2>
		</div>

		<ul class="myorder_sort">
			<li class="list1">
				<h3 class="title_sub4 Pt0 Pb0">주문상품</h3>
			</li>
			<li class="list2 Pt5">
				<!--{ ? orders.payment != 'pos_pay' }-->
					<!--{ ? orders.step == 15 }-->
					<button type="button" class="btn_resp size_b pointcolor3 imp" onclick="order_cancel('{orders.order_seq}');">주문무효</button>
					<!--{ / }-->
					<!--{ ? refund_able_ea && orders.step >= 25 && orders.step < 85 && !orders.orign_order_seq }-->
					<button type="button" class="btn_resp size_b pointcolor3 imp" onclick="order_refund('{orders.order_seq}');">결제취소</button>
					<!--{ / }-->
					<!--{ ? items_tot.coupontotal > 0 && in_array(orders.step,array(40,50,55,60,70,75)) }-->
					<button type="button" class="btn_resp size_b pointcolor3 imp" onclick="order_return_coupon('{orders.order_seq}');">티켓상품 환불신청</button>
					<!--{ / }-->
					<!--{? ( items_tot.goodstotal && return_able_ea) }-->
					<button type="button" class="btn_resp size_b pointcolor3 imp" onclick="order_return('{orders.order_seq}');">반품신청</button>
					<button type="button" class="btn_resp size_b pointcolor3 imp" onclick="order_exchange('{orders.order_seq}');">교환신청</button>
					<!--{ / }-->
				<!--{ / }-->
				<!--{ ? is_btn_tradeinfo }-->
				<button type="button" class="btn_resp size_b color5" onclick="{btn_tradeinfo_script}">거래명세서</button>
				<!--{ / }-->
			</li>
		</ul>

		<div class="res_table">
			<ul class="thead">
				<li>주문상품</li>
				<li style="width:45px;">수량</li>
				<li style="width:90px;">상품금액</li>
				<li style="width:75px;">할인금액</li>
				<li style="width:90px;">할인적용금액</li>
				<!--{ ? orders.member_seq }--><li style="width:64px;">적립</li><!--{ / }-->
				<li style="width:80px;">상태</li>
				<li style="width:100px;">배송비</li>
			</ul>
<!--{ @ shipping_group_items }-->
	<!--{ @ .items }-->
		<!--{ @ ..options }-->
			<!--{?..goods_type == 'gift'}-->
			<ul class="tbody gift { ? ..index_ == 0 && ...index_ == 0 }{ : }besong_grouped{ / }">
			<!--{:}-->
			<ul class="tbody { ? ..index_ == 0 && ...index_ == 0 }{ : }besong_grouped{ / }">
			<!--{/}-->
				<li class="subject">
					<ul class="board_goods_list">
						<li class="pic">
							<!--{ ? ..goods_type == 'gift'}-->
							<img src="{..image}" alt="" />
							<!--{ : }-->
							<a href='/goods/view?no={..goods_seq}' target='_blank' title="새창"><img src="{..image}" alt="{.goods_name}" /></a>
							<!--{ / }-->
						</li>
						<li class="info">
							<div class="title">
								<!--{ ? ..goods_type == 'gift' || ..cancel_type == '1' || ..tax == 'exempt' }-->
								<div class="Pb5">
									<!--{?..goods_type == 'gift'}-->
									<span class="pointcolor2">[사은품]</span>
									<!--{/}-->
									<!--{ ? ..cancel_type == '1' }-->
									<span class="pointcolor2">[청약철회불가]</span>
									<!--{ / }-->
									<!--{ ? ..tax == 'exempt' }-->
									<span class="pointcolor2">[비과세]</span>
									<!--{ / }-->
								</div>
								<!--{ / }-->
								<!--{ ? ..goods_type == 'gift'}-->
								{..goods_name}
								<!--{ : }-->
								<a href='/goods/view?no={..goods_seq}' target='_blank' title="새창">{..goods_name}</a>
								<!--{ / }-->
								<!--{ ? ..adult_goods == 'Y' }-->
								<img src="../images/common/auth_img.png" height="17" alt="성인" />
								<!--{ / }-->
								<!--{ ? ..option_international_shipping_status == 'y' }-->
								<img src="../images/common/plane.png" height="14" alt="해외배송상품" />
								<!--{ / }-->
							</div>
							<!--{?...option1}-->
							<div class="cont3">
								<span class="res_option_inline"><!--{?...title1}--><span class="xtle">{...title1}</span><!--{ / }-->{...option1}</span>
								<!--{?...option2 }--><span class="res_option_inline"><!--{?...title2}--><span class="xtle">{...title2}</span><!--{ / }-->{...option2}</span><!--{ / }-->
								<!--{?...option3 }--><span class="res_option_inline"><!--{?...title3}--><span class="xtle">{...title3}</span><!--{ / }-->{...option3}</span><!--{ / }-->
								<!--{?...option4 }--><span class="res_option_inline"><!--{?...title4}--><span class="xtle">{...title4}</span><!--{ / }-->{...option4}</span><!--{ / }-->
								<!--{?...option5 }--><span class="res_option_inline"><!--{?...title5}--><span class="xtle">{...title5}</span><!--{ / }-->{...option5}</span><!--{ / }-->
							</div>
							<!--{ / }-->
							<!--{ ? ...inputs }-->
							<div class="cont3">
								<!--{ @ ...inputs }-->
								<!--{ ? ....value }-->
								<span class="res_option_inline">
									<!--{?....title}--><span class="xtle v2">{....title}</span><!--{ / }--><!--{?....type=='file'}--><a href="../mypage_process/filedown?file={....value}" target="actionFrame" class="gray_05" title="다운로드">{....value}</a><!--{:}-->{....value}<!--{ / }-->
								</span>
								<!--{ / }-->
								<!--{ / }-->
							</div>
							<!--{ / }-->
							{? ..goods_type == 'gift' }
								{? ..gift_title }
								<div class="cont2">
									{..gift_title} <button type="button" class="gift_log btn_resp size_a color6" order_seq="{=orders.order_seq}" item_seq="{..item_seq}">자세히</button>
								</div>
								{ / }
							{ / }
						</li>
					</ul>
				</li>
				<li><span class="mtitle">수량:</span> {...ea}</li>
				<li class="right"><span class="mtitle">금액:</span> {=get_currency_price(...out_price,2)}</li>
				<li class="right">
					<span class="mtitle">할인:</span>
					<span class="pointcolor3">{=get_currency_price(...out_event_sale + ...out_multi_sale + ...out_coupon_sale + ...out_member_sale + ...out_fblike_sale + ...out_mobile_sale + ...out_promotion_code_sale + ...out_referer_sale ,2)}</span>

					{? (...out_event_sale + ...out_multi_sale + ...out_coupon_sale + ...out_member_sale + ...out_fblike_sale + ...out_mobile_sale + ...out_promotion_code_sale + ...out_referer_sale) > 0 }
					<button type="button" class="btn_resp size_a" onclick="showCenterLayer(this, 'brother')">내역</button>
					<div class="resp_layer_pop hide">
						<h4 class="title">할인 내역</h4>
						<div class="y_scroll_auto2">
							<div class="layer_pop_contents v5">
								<table class="table_row_a" cellpadding="0" cellspacing="0">
									<colgroup><col class="size_a" /><col /></colgroup>
									<tbody>
										<!--{ ? ...out_event_sale && ...out_event_sale > 0 }-->
										<tr>
											<th scope="row"><p>이벤트할인</p></th>
											<td>{=get_currency_price(...out_event_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_multi_sale && ...out_multi_sale > 0 }-->
										<tr>
											<th scope="row"><p>복수구매할인</p></th>
											<td>{=get_currency_price(...out_multi_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_member_sale && ...out_member_sale > 0 }-->
										<tr>
											<th scope="row"><p>등급할인</p></th>
											<td>{=get_currency_price(...out_member_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_mobile_sale && ...out_mobile_sale > 0 }-->
										<tr>
											<th scope="row"><p>모바일</p></th>
											<td>{=get_currency_price(...out_mobile_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_fblike_sale && ...out_fblike_sale > 0 }-->
										<tr>
											<th scope="row"><p>좋아요</p></th>
											<td>{=get_currency_price(...out_fblike_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_coupon_sale && ...out_coupon_sale > 0 }-->
										<tr>
											<th scope="row"><p>쿠폰할인</p></th>
											<td>{=get_currency_price(...out_coupon_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_promotion_code_sale && ...out_promotion_code_sale > 0 }-->
										<tr>
											<th scope="row"><p>코드할인</p></th>
											<td>{=get_currency_price(...out_promotion_code_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_referer_sale && ...out_referer_sale > 0 }-->
										<tr>
											<th scope="row"><p>유입경로</p></th>
											<td>{=get_currency_price(...out_referer_sale,2)}</td>
										</tr>
										<!--{ / }-->
									</tbody>
								</table>
							</div>
						</div>
						<div class="layer_bottom_btn_area2">
							<button type="button" class="btn_resp size_c color5 Wmax" onclick="hideCenterLayer()">확인</button>
						</div>
						<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
					</div>
					{ / }
				</li>
				<li class="right">
					<span class="mtitle">할인적용:</span>
					<strong class="pointcolor2">{=get_currency_price(...out_price-...out_tot_sale,2)}</strong>
				</li>
				<!--{ ? orders.member_seq }-->
				<li class="right">
					<span class="mtitle">적립:</span>
					{=get_currency_price(...out_reserve, 2)}<!--{ ? isplusfreenot && isplusfreenot.ispoint }--><div class="res_point_span">{=get_currency_price(...out_point)}P</div><!--{ / }-->
				</li>
				<!--{ / }-->
				<li class="mo_end v2">
					<span class="reply_title gray_01">
                        <!--{ ? orders.payment != 'pos_pay' }-->
                            {...mstep}
                        <!--{ : }-->
                            오프라인<br/>매장 주문
                        <!--{ / }-->
					</span>
				</li>
				<!--{ ? ..index_ == 0 && ...index_ == 0 }-->
				<li class="besong_group2 left {? .totalitems > 1}rowspan{/}">
					<!--{ ? orders.payment != 'pos_pay' }-->
						<div class="rcont">
							<strong class="mtitle gray_01">배송그룹:</strong>
							<!--{ ? .shipping.provider_name }-->
							<span class="gray_06">[{=.shipping.provider_name}]</span>
							<!--{ / }-->
							<!--{ ? .shipping.shipping_set_code == 'coupon' }-->
								[티켓발송]
							<!--{ : }-->
								<div class="Dib">{.shipping.shipping_set_name}</div>
								<!--{ ? .shipping.delivery_cost > 0 }-->
								<div><strong class="pointcolor2">{=get_currency_price(.shipping.shipping_cost,2)}</strong></div>
								<!--{ : }-->
								<div><strong class="pointcolor">무료</strong></div>
								<!--{ / }-->
							<!--{ / }-->

							<!--{ ? .shipping.shipping_set_code == 'direct_store' }-->
							<div class="ship_info">수령매장 : {.shipping.shipping_store_name}</div>
							<!--{ : }-->
								<!--{ ? .shipping.delivery_cost > 0 }-->
									<!--{ ? .shipping.shipping_type == 'prepay' }-->
							<div class="ship_info">(주문시 결제)</div>
									<!--{ : .shipping.shipping_type == 'postpaid' }-->
							<div class="ship_info">(착불)</div>
									<!--{ : }-->
							<div class="ship_info">(무료)</div>
									<!--{ / }-->
								<!--{ / }-->
							<!--{ / }-->
							<!--{ ? .shipping.shipping_hop_date }-->
							<div class="ship_info">희망배송일 : {.shipping.shipping_hop_date}</div>
							<!--{ : .shipping.reserve_sdate }-->
							<div class="ship_info">예약배송일 : {.shipping.reserve_sdate}</div>
							<!--{ / }-->
						</div>
					<!--{ : }-->
						<div class="rcont">
							<div class="ship_info">{.shipping.shipping_store_name}</div>
						</div>
					<!--{ / }-->
				</li>
				<!--{ : }-->
				<li class="rowspaned"></li>
				<!--{ / }-->
			</ul>

			<!--{ @ ...suboptions }-->
			<ul class="tbody suboptions">
				<li class="subject">
					<!--{ ? ....suboption }-->
					<div class="reply_ui">
						{?....title}<span class="xtle v3">{....title}</span>{/} {....suboption}
					</div>
					<!--{ / }-->
				</li>
				<li><span class="mtitle">수량:</span> {....ea}</li>
				<li class="right"><span class="mtitle">금액:</span> {=get_currency_price(....out_price,2)}</li>
				<li class="right">
					<span class="mtitle">할인:</span>
					<span class="pointcolor3">{=get_currency_price(....out_event_sale + ....out_multi_sale + ....out_coupon_sale + ....out_member_sale + ....out_fblike_sale + ....out_mobile_sale + ....out_promotion_code_sale + ....out_referer_sale ,2)}</span>
					<!--{ ? (....out_event_sale + ....out_multi_sale + ....out_coupon_sale + ....out_member_sale + ....out_fblike_sale + ....out_mobile_sale + ....out_promotion_code_sale + ....out_referer_sale) > 0 }-->
					<button type="button" class="btn_resp size_a" onclick="showCenterLayer(this, 'brother')">내역</button>
					<div class="resp_layer_pop hide">
						<h4 class="title">할인 내역</h4>
						<div class="y_scroll_auto2">
							<div class="layer_pop_contents v5">
								<table class="table_row_a" cellpadding="0" cellspacing="0">
									<colgroup><col class="size_a" /><col /></colgroup>
									<tbody>
										<!--{ ? ...out_event_sale }-->
										<tr>
											<th scope="row"><p>이벤트할인</p></th>
											<td>{=get_currency_price(...out_event_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ...out_multi_sale }-->
										<tr>
											<th scope="row"><p>복수구매할인</p></th>
											<td>{=get_currency_price(...out_multi_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ....out_member_sale }-->
										<tr>
											<th scope="row"><p>등급할인</p></th>
											<td>{=get_currency_price(....out_member_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ....out_mobile_sale }-->
										<tr>
											<th scope="row"><p>모바일</p></th>
											<td>{=get_currency_price(....out_mobile_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ....out_fblike_sale }-->
										<tr>
											<th scope="row"><p>좋아요</p></th>
											<td>{=get_currency_price(....out_fblike_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ....out_coupon_sale }-->
										<tr>
											<th scope="row"><p>쿠폰할인</p></th>
											<td>{=get_currency_price(....out_coupon_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ....out_promotion_code_sale }-->
										<tr>
											<th scope="row"><p>코드할인</p></th>
											<td>{=get_currency_price(....out_promotion_code_sale,2)}</td>
										</tr>
										<!--{ / }-->
										<!--{ ? ....out_referer_sale }-->
										<tr>
											<th scope="row"><p>유입경로</p></th>
											<td>{=get_currency_price(....out_referer_sale,2)}</td>
										</tr>
										<!--{ / }-->
									</tbody>
								</table>
							</div>
						</div>
						<div class="layer_bottom_btn_area2">
							<button type="button" class="btn_resp size_c color5 Wmax" onclick="hideCenterLayer()">확인</button>
						</div>
						<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
					</div>
					<!--{ / }-->
				</li>
				<li class="right">
					<span class="mtitle">할인적용:</span>
					<strong class="pointcolor2">{=get_currency_price(....out_price-....out_tot_sale,2)}</strong>
				</li>
				<!--{ ? orders.member_seq }-->
				<li class="right">
					<span class="mtitle">적립:</span>
					{=get_currency_price(....out_reserve,2)}<!--{ ? isplusfreenot && isplusfreenot.ispoint }--><div class="res_point_span">{=get_currency_price(....out_point)}P</div><!--{ / }-->
				</li>
				<!--{ / }-->
				<li class="mo_end v2 gray_01">
					<span class="reply_title gray_01">
                        <!--{ ? orders.payment != 'pos_pay' }-->
							{....mstep}
                        <!--{ : }-->
                            오프라인<br/>매장 주문
                        <!--{ / }-->
					</span>
				</li>
				<li class="rowspaned"></li>
			</ul>
			<!--{ / }-->

		<!--{ / }-->
	<!--{ / }-->
<!--{ / }-->
		</div>


		<ul class="sub_layout_z1">

			<!-- ++++++++++++++ LEFT Area ++++++++++++++ -->
			<li class="layout_aside_a">
				<h3 class="title_sub4">주문자</h3>
				<ul class="list_01 v2">
					<li>
						<strong class="Fs15 gray_01">{orders.order_user_name}</strong>
					</li>
					<li>
						<span class="phone1">{orders.order_cellphone}</span>
						<!--{ ? orders.order_phone }-->
						<span class="gray_07">&nbsp;/&nbsp;</span>
						<span class="Dib phone2">{orders.order_phone}</span>
						<!--{ / }-->
						<!--{ ? orders.order_email }-->
						<span class="gray_07">&nbsp;/&nbsp;</span>
						<span class="Dib email1">{orders.order_email}</span>
						<!--{ / }-->
					</li>
				</ul>

				<div class="orderSettle">
					<h3 class="title_sub4">배송지</h3>
					<div id="view_address_wrap">
						<ul class="delivery_member list_01 v2">
							<li>
								<strong class="recipient_user_name Fs15 pointcolor imp">{orders.recipient_user_name}</strong> &nbsp;
								<!--{ ? orders.step <= 25 && orders.shipping_group_exists == 'Y' && orders.shipping_group_set_exists == 'Y'}-->
									<button type="button" class="btn_resp" onclick="mode_change('address_wrap', 'edit')">수정</button>
									<!--{? defined('__ISUSER__') && is_goods // 회원만 배송 주소록 표시}-->
									<!-- 에러 개선될때까지 미노출 처리 -->
									<button type="button" class="btn_resp" style="display:none;" onclick="popDeliveryaddress();">배송주소록</button>
									<!--{/}-->
								<!--{/}-->
							</li>
							<!--{ ? is_goods }-->
							<li class="domestic" {? orders.international != 'domestic'}style="display:none;"{/}>
								[<span class="recipient_zipcode">{orders.merge_recipient_zipcode}</span>]
								<!--{ ? orders.recipient_address_type == 'street' }-->
								<span class="recipient_address_street data2">{orders.recipient_address_street}</span>
								<!--{ : }-->
								<span class="recipient_address data2">{orders.recipient_address}</span>
								<!--{ / }-->
								<span class="recipient_address_detail">{orders.recipient_address_detail}</span><br/>
								<span class="desc">
								(
									<!--{ ? orders.recipient_address_type == 'street' }-->
									<span class="recipient_address data2">{orders.recipient_address}</span>
									<!--{ : }-->
									<span class="recipient_address_street data2">{orders.recipient_address_street}</span>
									<!--{ / }-->
									<span class="recipient_address_detail">{orders.recipient_address_detail}</span>
								)
								</span>
							</li>
							<li class="international" {? orders.international != 'international'}style="display:none;"{/}>
								{? orders.international_address}<span class="international_address">{orders.international_address}</span>, {/}
								{? orders.international_town_city}<span class="international_town_city">{orders.international_town_city}</span>, {/}
								{? orders.international_county}<span class="international_county">{orders.international_county}</span>, {/}
								{? orders.international_country}<span class="international_country">{orders.international_country}</span>{/}
							</li>
							<!--{ / }-->
							<li>
								<span class="recipient_cellphone data2">{orders.merge_recipient_cellphone}</span>
								<span { ? !orders.merge_recipient_phone }style="display:none;"{/}>
									<span class="gray_07">&nbsp;/&nbsp;</span>
									<span class="Dib recipient_phone data2">{orders.merge_recipient_phone}</span>
								</span>
								<span { ? !orders.recipient_email }style="display:none;"{/}>
									<span class="gray_07">&nbsp;/&nbsp;</span>
									<span class="Dib recipient_email data2">{orders.recipient_email}</span>
								</span>
							</li>
							<!--{ ? is_goods }-->
							<li class="gray_06">
								배송국가 : <span class="nation_name data2">{orders.nation_name_kor}</span>
								<input type="hidden" id="address_nation" name="address_nation" value="{ini_info.nation}" />
							</li>
							<!--{ / }-->
							<!--{ ? is_direct_store }-->
							<li class="desc">※ 매장수령 상품은 매장에서 수령하세요.</li>
							<!--{ / }-->
							<!--{ ? is_coupon }-->
							<li class="desc">※ 티켓번호는 문자와 이메일로 보내드립니다.</li>
							<!--{ / }-->
							<li {? !orders.each_memo && !orders.memo}style="display:none;"{/}>
								<!--{ ? is_array(orders.memo) }-->
									<!--{ @ orders.memo.ship_message }-->
								<div>
									<span class="desc">({orders.memo.goods_info[.key_]}{? orders.memo.goods_option[.key_]} - {orders.memo.goods_option[.key_]}{/})</span><br/>
									<span class="recipient_ship_messages">{orders.memo.ship_message[.key_]}</span>
								</div>
									<!--{ / }-->
								<!--{ : }-->
								<span class="recipient_ship_message">{orders.memo}</span>
								<!--{ / }-->
							</li>
							<!--{ ? orders.clearance_unique_personal_code }-->
							<li>
								<p class="Pb2">[해외구매대행상품]</p>
								개인통관고유부호: <span class="clearance_unique_personal_code pointcolor">{orders.clearance_unique_personal_code}</span>
							</li>
							<!--{ / }-->
						</ul>

					</div>

					<form name="recipient" method="post" action="../mypage_process/recipient" target="actionFrame">
					<input type="hidden" name="order_seq" value="{orders.order_seq}" />
					<input type="hidden" name="international" value="{orders.international}" />
					<div id="edit_address_wrap" class="resp_layer_pop hide">
						<h4 class="title">배송지 수정</h4>
						<div class="y_scroll_auto2">
							<div class="layer_pop_contents v5">
								<ul class="shipping_delivery_input list_01 v2">
									<li>
										<input type="text" name="recipient_user_name" value="{orders.recipient_user_name}" style="width:170px;" title="받는분" />
									</li>
									<!--{ ? is_goods }-->
									<!-- 국내 -->
									<li class="domestic goods_delivery_info">
										<input type="text" name="recipient_new_zipcode" value="{orders.merge_recipient_zipcode}" class="size_zip_all" maxlength="7" title="우편번호" readonly />
										<button type="button" class="btn_resp size_b color4" onclick="openDialogZipcode_resp('recipient_');">검색</button>
										<input type="hidden" name="recipient_address_type" value="{members.default_address.address_type}" size="45" title="주소구분" />
										<input type="text" name="recipient_address_street" value="{orders.recipient_address_street}" class="size_address Mt5" title="도로명 주소" {? orders.recipient_address_type!='street'} style="display:none;"{/} readonly />
										<input type="text" name="recipient_address" value="{orders.recipient_address}" class="size_address Mt5" title="지번주소" {? orders.recipient_address_type=='street'}style="display:none;"{/} readonly />
										<input type="text" name="recipient_address_detail" value="{orders.recipient_address_detail}" class="size_address Mt5" title="상세주소" required />
									</li>
									<!-- 해외 -->
									<li class="international goods_delivery_info">
										<select name="region" class="hide">
										<!--{ @ shipping_policy.policy[1][0].region }-->
											<!--{ ? .key_ == orders.region }-->
											<option value="{.key_}">{.value_}</option>
											<!--{ / }-->
										<!--{ / }-->
										</select>
										<input type="text" name="international_address" value="{orders.international_address}" class="size_full Mt5" title="주소" required />
										<input type="text" name="international_town_city" value="{orders.international_town_city}" class="size_full Mt5" title="시도" required />
										<input type="text" name="international_county" value="{orders.international_county}" class="size_full Mt5" title="주" required />
										<input type="text" name="international_postcode" value="{orders.international_postcode}" class="size_full Mt5" title="우편번호" required />
										<input type="text" class="hide" name="international_country" value="{orders.international_country}" title="국가" readonly required />
									</li>
									<!--{ / }-->

									<!-- 연락처 -->
									<li class="base_phone">
										<input type="tel" name="recipient_cellphone[]" value="{orders.recipient_cellphone[0]}" style="width:64px;" maxlength="4" title="휴대폰" valid="휴대폰" /> -
										<input type="tel" name="recipient_cellphone[]" value="{orders.recipient_cellphone[1]}" style="width:64px;" maxlength="4" title="휴대폰" valid="휴대폰" /> -
										<input type="tel" name="recipient_cellphone[]" value="{orders.recipient_cellphone[2]}" style="width:64px;" maxlength="4" title="휴대폰" valid="휴대폰" />
										{ ? orders.merge_recipient_phone}
										<button type="button" id="btn_delivery_add_phone" class="add_phone_btn btn_resp size_b color4" onclick="add_phone(this,'close')">추가연락처 ▲</span>
										{ : }
										<button type="button" id="btn_delivery_add_phone" class="add_phone_btn btn_resp size_b" onclick="add_phone(this,'open');">추가연락처 ▼</span>
										{ / }
									</li>
									<li class="add_phone{ ? !orders.merge_recipient_phone} hide{/}">
										<input type="tel" class="add_phone_input" name="recipient_phone[]" value="{orders.recipient_phone[0]}" style="width:64px;" maxlength="4" title="추가" /> -
										<input type="tel" class="add_phone_input" name="recipient_phone[]" value="{orders.recipient_phone[1]}" style="width:64px;" maxlength="4" title="추가" /> -
										<input type="tel" class="add_phone_input" name="recipient_phone[]" value="{orders.recipient_phone[2]}" style="width:64px;" maxlength="4" title="추가" />
									</li>

									<li><input type="text" name="recipient_email" value="{orders.recipient_email}" class="size_email_full" title="받는분 이메일주소" /></li>

									<!-- 배송 메세지 -->
									<li id="shipMessage" class="goods_delivery_info">
										<!--{ ? is_array(orders.memo) }-->
										<div class="each_ship_msg">
											<!--{ @ orders.memo.ship_message }-->
											<div class="ship-lay">
												<div class="goods_info_txt">{orders.memo.goods_info[.key_]}{? orders.memo.goods_option[.key_]} - {orders.memo.goods_option[.key_]}{/}</div>
												<div class="ship_message Mt0">
													<input type="text" class="ship_message_txt" name="each_memo[{.key_}]" title="배송 메시지를 입력하세요." value="{orders.memo.ship_message[.key_]}" autocomplete="off" />
													<ul class="add_message Mb30">
														<li>배송 전에 미리 연락해 주세요.</li>
														<li>부재시 경비실에 맡겨 주세요.</li>
														<li>부재시 전화 주시거나 문자 남겨 주세요.</li>
													</ul>
												</div>
												<div class="desc Pt5">
													<strong class="cnt_txt gray_01">0</strong> / 300
												</div>
											</div>
											<!--{ / }-->
										</div>
										<!--{ : }-->
										<div class="ship-lay total_ship_msg">
											<div class="ship_message Mt0">
												<input type="text" class="ship_message_txt" name="memo" id="memo" title="배송 메시지를 입력하세요." value="{orders.memo}" autocomplete="off" />
												<ul class="add_message Mb30">
													<li>배송 전에 미리 연락해 주세요.</li>
													<li>부재시 경비실에 맡겨 주세요.</li>
													<li>부재시 전화 주시거나 문자 남겨 주세요.</li>
												</ul>
											</div>
											<div class="desc Pt5">
												<strong class="cnt_txt gray_01">0</strong> / 300
											</div>
										</div>
										<!--{ / }-->
									</li>

									<!--{ ? orders.clearance_unique_personal_code }-->
									<li>
										개인통관고유부호 : <input type="text" name="clearance_unique_personal_code" value="{orders.clearance_unique_personal_code}" style="width:160px;" />
									</li>
									<!--{ / }-->
								</ul>
							</div>
						</div>
						<div class="layer_bottom_btn_area2 v2">
							<ul class="basic_btn_area2">
								<!--{ ? orders.step <= 25 && orders.shipping_group_exists == 'Y' && orders.shipping_group_set_exists == 'Y' }-->
								<li><button type="submit" class="btn_resp size_c color2">수정 완료</button></li>
								<!--{ / }-->
								<li><button type="button" class="btn_resp size_c color5" onclick="hideCenterLayer()">취소</button></li>
							</ul>
						</div>
						<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
					</div>
					</form>
				</div>
			</li>
			<!-- ++++++++++++++ //LEFT Area ++++++++++++++ -->

			<!-- ++++++++++++++ RIGHT Area ++++++++++++++ -->
			<li class="layout_aside_b">
				<!-- 결제 금액 -->
				<h3 class="title_sub4">결제 금액</h3>
				<div class="order_price_total">
					<ul>
						<li class="th"><strong>상품금액</strong></li>
						<li class="td">{=get_currency_price(items_tot.price,2, '', '<span class="total_goods_price2">_str_price_</span>')}</li>
					</ul>
					<ul>
						<li class="th">
							배송비&nbsp;
							<button type="button" class="btn_resp size_a gray_05" onclick="showCenterLayer('#besongDetailList')">내역</button>
						</li>
						<li class="td">
							(+) {=get_currency_price(shipping_tot.tot_origin_shipping_cost,2)}
						</li>
					</ul>
					<ul>
						<li class="th">
							할인금액&nbsp;
							<button type="button" class="btn_resp size_a gray_05" onclick="showCenterLayer('#saleDetailList')">내역</button>
						</li>
						<li class="td pointcolor3">
							<span>(-)</span> {=get_currency_price(items_tot.event_sale + items_tot.multi_sale + items_tot.member_sale+items_tot.mobile_sale+items_tot.fblike_sale+items_tot.coupon_sale+items_tot.promotion_code_sale+items_tot.referer_sale+shipping_tot.coupon_sale+shipping_tot.code_sale+orders.enuri,2)}
						</li>
					</ul>
					<!--{ ? members }-->
					{ ? orders.emoney > 0 }
					<ul>
						<li class="th">마일리지 사용</li>
						<li class="td pointcolor3">
							<span>(-)</span> {=get_currency_price(orders.emoney,2)}
						</li>
					</ul>
					{ / }
					{ ? orders.cash > 0 }
					<ul>
						<li class="th">예치금 사용</li>
						<li class="td pointcolor3">
							<span>(-)</span> {=get_currency_price(orders.cash,2)}
						</li>
					</ul>
					{ / }
					<!--{ / }-->
					<ul class="total">
						<li class="th">최종 결제금액</li>
						<li class="td">
							<span class="price">{=get_currency_price(orders.settleprice,2,'','<span class="settle_price">_str_price_</span>')}</span>
							<div class="settle_price_compare total_result_price gray_05">{=total_price_compare}</div>
						</li>
					</ul>
				</div>

				<!-- 주문결제정보 -->
				<h3 class="title_sub4">주문결제정보</h3>
				<table class="table_row_a" cellpadding="0" cellspacing="0">
				<colgroup><col width="84"><col></colgroup>
				<tbody>
					<tr>
						<th scope="row"><p>주문번호</p></th>
						<td>{orders.order_seq}</td>
					</tr>
					<tr>
						<th scope="row"><p>주문날짜</p></th>
						<td>{=date('Y-m-d H:i', strtotime(orders.regist_date))}</td>
					</tr>
					<tr>
						<th scope="row"><p>주문상태</p></th>
						<td>
							<!--{ ? orders.payment != 'pos_pay' }-->
							{orders.step_info} {? orders.step == 99 } [CODE: {orders.pg_log.res_cd}] {orders.pg_log.res_msg} { / }
							<!--{ : }-->
								오프라인 매장 주문
							<!--{ / }-->
						</td>
					</tr>
					<tr>
						<th scope="row"><p>결제일시</p></th>
						<td>
							<!--{ ? orders.deposit_yn == 'n' }-->
							입금대기
							<!--{ : }-->
							{=date('Y-m-d H:i:s', strtotime(orders.deposit_date))}
							<!--{ / }-->
						</td>
					</tr>
					<tr>
						<th scope="row"><p>결제방식</p></th>
						<td>
							{orders.mpayment}
							<!--{ ? orders.payment == 'bank' }-->
							<span class="Dib">(입금자명:{orders.depositor})</span>
							<!--{ : orders.payment == 'card' && orders.payment_cd != 'MONEY' }-->
							<span class="Dib">({? order_pg_log.card_name}{order_pg_log.card_name}/{/}{?orders.card_quota>0}{orders.card_quota}개월할부{:}일시불{/})</span>
							<!--{ / }-->
						</td>
					</tr>
					<!--{ ? orders.bank_account || orders.virtual_account }-->
					<tr>
						<th scope="row"><p>입금계좌</p></th>
						<td>
							{account_number.bank_name}
							<span class="Dib">{account_number.account_number}</span>
							<!--{ ? account_number.account_owner }-->
							<span class="Dib">({account_number.account_owner})</span>
							<!--{ / }-->
						</td>
					</tr>
					<!--{ / }-->
					<!--{ ? orders.deposit_yn == 'n' && cfg_order.autocancel_txt }-->
					<tr>
						<th scope="row"><p>입금기간</p></th>
						<td>{cfg_order.autocancel_txt}</td>
					</tr>
					<!--{ / }-->
					<tr>
						<th scope="row"><p>결제금액</p></th>
						<td><strong>{=get_currency_price(orders.settleprice,2)}</strong></td>
					</tr>
					<!--{ ? orders.payment != 'pos_pay' }-->
						<!--{ ? orders.step != 95 && orders.step != 85 && orders.step != 99 }-->
							<!--{ ? orders.typereceipt > 0 && (tax.tstep == 1 || tax.tstep == 2 || tax.tstep == 4 || creceipt.tstep == 1 || creceipt.tstep == 2 || creceipt.tstep == 4) }-->
								<tr>
									<th scope="row"><p>증빙자료</p></th>
								<!--{? orders.typereceipt == 1 }-->
									<td>
									<!--{? tax.tstep == 1 || tax.tstep == 2 || tax.tstep == 4 }-->
										<!--{? (tax.tstep == 1)}-->
											<button type="button" class="btn_resp" id="taxcashbtn{tax.tstep}" deposit="{orders.deposit_yn}">세금계산서</button>
										<!--{: tax.tstep == 2}-->
											<!--{? tax.approach == 'unlink' }-->
											<button type="button" class="btn_resp taxCompleteOver">세금계산서</button>
											<!--{: tax.approach == 'link' || tax.approach == 'auto' || !tax.approach}-->
											<button type="button" class="btn_resp" id="taxcashbtn{tax.tstep}" sales_seq="{tax.seq}"  order_seq ="{orders.order_seq }" settleprice="{orders.settleprice}" >세금계산서</button>
											<!--{/}-->
										<!--{: tax.tstep == 4}-->
											<button type="button" class="btn_resp" id="taxcashbtn{tax.tstep}">세금계산서</button>
										<!--{/}-->
										<!--{? tax.tstep == 1}-->
											발급대기
										<!--{ / }-->
									<!--{ / }-->
									</td>
								<!--{ : orders.typereceipt == 2 }-->
									<td>
										<!--{? creceipt.tstep == 1 || creceipt.tstep == 2 || creceipt.tstep == 4 }-->
											<!--{? (creceipt.tstep == 1 || tax.tstep == 1)}-->
												<button type="button" class="btn_resp" id="pgcashbtn{creceipt.tstep}" deposit="{orders.deposit_yn}">현금영수증</button>
											<!--{: creceipt.tstep == 2 || tax.tstep == 2}-->
												<!--{? !creceipt.cash_no }-->
												<button type="button" class="btn_resp completeOver">현금영수증</button>
												<!--{:}-->
												<button type="button" class="btn_resp" id="pgcashbtn{creceipt.tstep}" sales_seq="{creceipt.seq}"  order_seq ="{orders.order_seq }" cash_no="{creceipt.cash_receipts_no}" settleprice="{orders.settleprice}" pg_kind="{creceipt.pg_kind}">현금영수증</button>
												<!--{/}-->
											<!--{: creceipt.tstep == 4}-->
												<button type="button" class="btn_resp" id="pgcashbtn{creceipt.tstep}">현금영수증</button>
											<!--{/}-->
												({?creceipt.cuse==0}개인소득공제{:creceipt.cuse==1}사업자지출증빙용{/})
											<!--{? creceipt.tstep == 1}-->
												발급대기 <button type="button" class="btn_resp cancelBtn" order_seq="{orders.order_seq}">발급취소</button>
											<!--{ / }-->
										<!--{ / }-->
									</td>
								<!--{ / }-->
								</tr>
							<!--{ : orders.payment == 'card' }-->
								<tr>
									<th scope="row"><p>증빙자료</p></th>
									<td>
										<button type="button" class="btn_resp" onclick="receiptView('{orders.pg_transaction_number}', '{pg.mallCode}', '{orders.order_seq }', '{orders.pg_kind}', '{orders.authdata}', '{orders.payment}');">신용카드매출전표</button>
									</td>
								</tr>
							<!--{ : orders.payment == 'cellphone' }-->
							<!--{ : }-->
								<!--{? ((cfg.order.sale_reserve_yn != 'Y' && orders.emoney > 0) && orders.settleprice <= 0) || ((cfg.order.sale_emoney_yn != 'Y' && orders.cash > 0) && orders.settleprice <= 0) }-->
								<!--{ : }-->
								<tr>
									<th scope="row"><p>증빙자료</p></th>
									<td>
									<!--{? orders.deposit_yn == 'n' }-->
										입금 후 신청 가능합니다.
									<!--{:}-->
										<select name="receipt_type" class="M">
											<option value="">선택</option>
											<!--{ ? cfg_order.taxuse > 0 }-->
											<option value="tax" receipt_possible="{orders.tax_receipt_possible}"{? orders.typereceipt == 1 } selected{/}>세금계산서</option>
											<!--{ / }-->
											<!--{ ? cfg_order.cashreceiptuse > 0 }-->
											<!--{? orders.settleprice > 0}-->
											<option value="cash" receipt_possible="{orders.cash_receipt_possible}"{? orders.typereceipt == 2 } selected{/}>현금영수증</option>
											<!--{ / }-->
											<!--{ / }-->
										</select>

										<!--{? (orders.tax_receipt_possible || orders.cash_receipt_possible) && orders.step >= 15 && orders.step <= 75 && !orders.orign_order_seq }-->
										<select id="receipt_apply" order_seq="{orders.order_seq}" step="{orders.step}" class="M" style="display:none;">
										<!--{:}-->
										<select id="receipt_apply" class="M" disabled>
										<!--{/}-->
											<option value="n" checked>미신청</option>
											<option value="y">신청</option>
										</select>
										<span class="receipt_date_limit gray_06"{? orders.typereceipt != 1 && orders.typereceipt != 0 } style="display:none;"{/}>{orders.tax_receipt_possible_txt}</span>
										<span class="receipt_date_limit gray_06"{? orders.typereceipt != 2 } style="display:none;"{/}>{orders.cash_receipt_possible_txt}</span>
									<!--{/}-->
									</td>
								</tr>
								<!--{ / }-->
							<!--{ / }-->
						<!--{ / }-->
					<!--{ / }-->
				</tbody>
				</table>

				<!--{?cfg_order.autocancel=='y' && cfg_order.cancelDuration>0}-->
				<div class="Pt10 pointcolor3">
					무통장입금으로 주문하신 고객님들 중 주문후 {cfg_order.cancelDuration}일 이내에 입금해 주시지 않으면 자동취소 처리될 수 있습니다.
				</div>
				<!--{/}-->
			</li>
			<!-- ++++++++++++++ //RIGHT Area ++++++++++++++ -->
		</ul>

		<!--{ ? count(order_shippings) >= 1 }-->
		<h3 class="title_sub4">배송 내역</h3>
			<!--{ @ order_shippings }-->
				<!--{ ? .exports }-->
				<div class="res_table">
					<ul class="thead">
						<li>상품</li>
						<li style="width:70px;">주문수량</li>
						<li style="width:90px;">발송수량</li>
						<li style="width:80px;">상품후기</li>
						<li style="width:170px;">발송정보</li>
					</ul>
					<!--{ @ .exports }-->
						<!--{ @ ..item }-->
						<ul class="tbody { ? ...opt_type != 'opt' }suboptions{ / } { ? ...index_ == 0 }{ : }besong_grouped{ / }">
							<li class="subject">
								<!--{ ? ...opt_type=='opt' }-->
								<ul class="board_goods_list">
									<li class="pic">
										<img src="{...image}" alt="" />
									</li>
									<li class="info">
										<div class="title">
											<!--{ ? ...goods_type == 'gift' }-->
											<span class="pointcolor2">[사은품]</span>
											<!--{ / }-->
											{ ...goods_name }
										</div>
										<!--{? ..goods_kind == 'coupon' }-->
										<div class="cont3">
											{ ...social_start_date } ~ { ...social_end_date }
										</div>
										<!--{ / }-->
										<!--{?...option1}-->
										<div class="cont3">
											<span class="res_option_inline"><!--{?...title1}--><span class="xtle">{...title1}</span><!--{ / }-->{...option1}</span>
											<!--{?...option2 }--><span class="res_option_inline"><!--{?...title2}--><span class="xtle">{...title2}</span><!--{ / }-->{...option2}</span><!--{ / }-->
											<!--{?...option3 }--><span class="res_option_inline"><!--{?...title3}--><span class="xtle">{...title3}</span><!--{ / }-->{...option3}</span><!--{ / }-->
											<!--{?...option4 }--><span class="res_option_inline"><!--{?...title4}--><span class="xtle">{...title4}</span><!--{ / }-->{...option4}</span><!--{ / }-->
											<!--{?...option5 }--><span class="res_option_inline"><!--{?...title5}--><span class="xtle">{...title5}</span><!--{ / }-->{...option5}</span><!--{ / }-->
										</div>
										<!--{ / }-->
									</li>
								</ul>
								<!--{ : }-->
								<div class="reply_ui">
									{?...title1}<span class="xtle v3">{...title1}</span>{/} {...option1}
								</div>
								<!--{ / }-->
							</li>
							<li class="{...opt_type}area"><span class="mtitle">주문:</span> {...opt_ea}</li>
							<li class="{...opt_type}area mo_end">
								<span class="mtitle">발송:</span> 
								{...ea}
								<!--{? ..goods_kind == 'coupon' }-->
								<div class="m_dib">
									({?...coupon_value_type=='pass'}{=number_format(..coupon_use_value)}회{:}{=get_currency_price(..coupon_use_value,2)}{/} /
									{?...coupon_value_type=='pass'}{=number_format(..coupon_input)}회{:}{=get_currency_price(..coupon_input,2)}{/})
								</div>
								<!--{ / }-->
							</li>
							<li class="{...opt_type}area">
								<!--{ ? ...goods_type != 'gift' && ...opt_type=='opt' }-->
								<button type="button" class="btn_resp res_board_boxad2" onclick="goods_review_write('{...goods_seq}','{.order_seq}');">상품후기</button>
								<!--{ / }-->
							</li>
							<!--{ ? ...index_ == 0 }-->
							<li class="{...opt_type}area besong_group2 left {? count(..item) > 1}rowspan{/}">
								<div class="rcont">
									<!--{ ? orders.payment != 'pos_pay' }-->
										<strong class="mtitle gray_01">배송그룹:</strong>
										<!--{ ? ..provider_name }-->
										<span class="gray_06">[{ ..provider_name }]</span>
										<!--{ / }-->
										<div class="Dib">{..shipping_set_name}</div>
										<div class="pointcolor2">{..export_date} 발송</div>
										<!--{? ..status==55 || ..status==65 || ..status==75}-->
										<div>[{..mstatus}]</div>
										<!--{/}-->
										<!--{? ..goods_kind == 'coupon' }-->
										<div>{ ...recipient_cellphone }</div>
										<div>{ ...recipient_email }</div>
										<!--{ : }-->
											<!--{? ..shipping_method == 'direct_store'}-->
											<div>{..direct_store.shipping_store_name}</div>
											<!--{/}-->
											<div>{..mdelivery}</div>
											<div class="btn_area_mx1">
												<!--{ ? ..goods_kind != 'coupon' && ..tracking_url }-->
												<button type="button" class="btn_resp" onclick="window.open('{..tracking_url}');">배송조회</button>
												<!--{ / }-->
											</div>
										<!--{ / }-->
									<!--{ : }-->
										<div class="pointcolor2">오프라인 매장 주문</div>
										<div>{..direct_store.shipping_store_name}</div>
									<!--{ / }-->
									<div class="btn_area_mx1">
										<!--{? ..goods_kind == 'coupon' }-->
										<button type="button" class="btn_resp" onclick="coupon_history('{..export_code}','{...coupon_serial}');">사용내역</button>
											<!--{ ? ..coupon_check_use['result'] == 'success' }-->
										<button type="button" class="btn_resp color2" onclick="coupon_use('{..export_code}','{...coupon_serial}');" title="새창">티켓사용</button>
											<!--{ : }-->
										[티켓사용]
											<!--{ / }-->
										<!--{ : }-->
											<!--{ ? ..buyconfirmInfo['btn_buyconfirm'] }-->
												<button type="button" class="btn_resp color2 exportbuyconfirm" export_code="{..export_code}" status="{..status}" >구매확정</button>
											<!--{ : }-->
												<!--{ ? ..buyconfirmInfo['reserve_buyconfirm_ea'] }-->
													구매확정 : {=substr(..data_buy_confirm.regdate, 0, 10)}{? ..data_buy_confirm.actor_id == 'system' } (자동){ / }
												<!--{ / }-->
											<!--{ / }-->
										<!--{ / }-->
									</div>
								</div>
							</li>
							<!--{ : }-->
							<li class="rowspaned"></li>
							<!--{ / }-->
						</ul>
						<!--{ / }-->
					<!--{ / }-->
				</div>
				<!--{ : }-->
				<div class="no_data_area2">
					배송(출고) 내역이 없습니다.
				</div>
				<!--{ / }-->
			<!--{ / }-->
		<!--{ / }-->

		<!--{ ? cancel_log || data_return || data_refund }-->
		<h3 class="title_sub4">무효/취소/반품 내역</h3>
		<div class="res_table">
			<ul class="thead">
				<li>무효/취소/반품</li>
				<li style="width:160px;">처리일시</li>
				<li style="width:100px;">처리수량</li>
				<li style="width:130px;">처리금액</li>
				<li>상세</li>
			</ul>
			<!--{ @cancel_log }-->
			<ul class="tbody">
				<li class="subject half t1"><strong class="reply_title pointcolor3 imp">{.title}</strong></li>
				<li class="subject half x1">{.regist_date}</li>
				<li><span class="mtitle">수량:</span> {.ea}</li>
				<li><span class="mtitle">금액:</span> {=get_currency_price(.price)}</li>
				<li class="mo_end">{.detail}&nbsp;</li>
			</ul>
			<!--{ / }-->
			<!--{ @ data_return }-->
			<ul class="tbody">
				<li class="subject half t1"><strong class="reply_title pointcolor3 imp">반품</strong></li>
				<li class="subject half x1"><a href="../mypage/return_view?return_code={.return_code}" target="_blank">{.regist_date}</a></li>
				<li><span class="mtitle">수량:</span> {.ea}</li>
				<li><span class="mtitle">금액:</span> {=get_currency_price(.opt_price + .sub_price,2)}</li>
				<li class="mo_end"><a href="../mypage/return_view?return_code={.return_code}" target="_blank">{.mstatus}</a>&nbsp;</li>
			</ul>
			<!--{ / }-->
			<!--{ @ data_refund }-->
			<ul class="tbody">
				<li class="subject half t1"><strong class="reply_title pointcolor3 imp">환불</strong></li>
				<li class="subject half x1"><a href="../mypage/refund_view?refund_code={.refund_code}" target="_blank">{.regist_date}</a></li>
				<li><span class="mtitle">수량:</span> {.ea}</li>
				<li><span class="mtitle">금액:</span> {=get_currency_price(.refund_price,2)}</li>
				<li class="mo_end"><a href="../mypage/refund_view?refund_code={.refund_code}" target="_blank">{.mstatus}</a>&nbsp;</li>
			</ul>
			<!--{ / }-->
		</div>
		<!--{ / }-->

		<!-- 하단 버튼 -->
		<div class="btn_area_c">
			<a href="/mypage/order_catalog" class="btn_resp size_c color5">주문/배송 내역</a>
		</div>

	</div>
	<!-- +++++ //mypage contents ++++ -->

</div>

<script type="text/javascript" src="../common/mypage_ui.js"></script><!-- mypage ui 공통 -->

<!-- 배송주소록 Layer -->
<div id="delivery_address_dialog" class="resp_layer_pop hide">
	<h4 class="title">배송 주소록</h4>
	<div class="y_scroll_auto">
		<div class="layer_pop_contents v3 delivery_often">
		</div>
	</div>
	<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
</div>

<!-- 배송비 내역 레이어 -->
<div id="besongDetailList" class="resp_layer_pop hide">
	<h4 class="title">배송비 내역</h4>
	<div class="y_scroll_auto2">
		<div class="layer_pop_contents v5">
			<ul class="od_layer_title1">
				<li class="td">총 <span class="pointcolor2">{=get_currency_price(shipping_tot.tot_origin_shipping_cost,2,'','<span class="totalprice_font">_str_price_</span>')}</span></li>
			</ul>
			<table class="table_row_a" cellpadding="0" cellspacing="0">
				<colgroup><col width="100" /><col /></colgroup>
				<tbody>
					<!--{ ? shipping_tot.std_cost > 0 }-->
					<tr>
						<th scope="row"><p>기본배송비</p></th>
						<td>{=get_currency_price(shipping_tot.std_cost,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? shipping_tot.add_cost > 0 }-->
					<tr>
						<th scope="row"><p>추가배송비</p></th>
						<td>{=get_currency_price(shipping_tot.add_cost,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? shipping_tot.hop_cost > 0 }-->
					<tr>
						<th scope="row"><p>희망배송비</p></th>
						<td>{=get_currency_price(shipping_tot.hop_cost,2)}</td>
					</tr>
					<!--{ / }-->
				</tbody>
			</table>
		</div>
	</div>
	<div class="layer_bottom_btn_area2">
		<button type="button" class="btn_resp size_c color5 Wmax" onclick="hideCenterLayer()">확인</button>
	</div>
	<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
</div>

<!-- 할인금액 내역 레이어 -->
<div id="saleDetailList" class="resp_layer_pop hide">
	<h4 class="title">할인금액 내역</h4>
	<div class="y_scroll_auto2">
		<div class="layer_pop_contents v5">
			<ul class="od_layer_title1">
				<li class="td">총 <span class="pointcolor">{=get_currency_price(items_tot.member_sale+items_tot.mobile_sale+items_tot.fblike_sale+items_tot.coupon_sale+items_tot.promotion_code_sale+items_tot.referer_sale+shipping_tot.coupon_sale+shipping_tot.code_sale+orders.enuri,2, '', '<span class="totalprice_font">_str_price_</span>')}</span>
			</ul>
			<table class="table_row_a" cellpadding="0" cellspacing="0">
				<colgroup><col width="100" /><col /></colgroup>
				<tbody>
					<!--{ ? items_tot.event_sale > 0 }-->
					<tr>
						<th scope="row"><p>이벤트할인</p></th>
						<td>{=get_currency_price(items_tot.event_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? items_tot.multi_sale > 0 }-->
					<tr>
						<th scope="row"><p>복수구매할인</p></th>
						<td>{=get_currency_price(items_tot.multi_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? items_tot.member_sale > 0 }-->
					<tr>
						<th scope="row"><p>등급할인</p></th>
						<td>{=get_currency_price(items_tot.member_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? items_tot.mobile_sale > 0 }-->
					<tr>
						<th scope="row"><p>모바일</p></th>
						<td>{=get_currency_price(items_tot.mobile_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? items_tot.fblike_sale > 0 }-->
					<tr>
						<th scope="row"><p>좋아요</p></th>
						<td>{=get_currency_price(items_tot.fblike_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? items_tot.coupon_sale > 0 }-->
					<tr>
						<th scope="row"><p>쿠폰할인</p></th>
						<td>{=get_currency_price(items_tot.coupon_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? items_tot.promotion_code_sale > 0 }-->
					<tr>
						<th scope="row"><p>할인코드</p></th>
						<td>{=get_currency_price(items_tot.promotion_code_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? items_tot.referer_sale > 0 }-->
					<tr>
						<th scope="row"><p>유입경로</p></th>
						<td>{=get_currency_price(items_tot.referer_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? shipping_tot.coupon_sale > 0 }-->
					<tr>
						<th scope="row"><p>배송비쿠폰</p></th>
						<td>{=get_currency_price(shipping_tot.coupon_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? shipping_tot.code_sale > 0 }-->
					<tr>
						<th scope="row"><p>배송비코드</p></th>
						<td>{=get_currency_price(shipping_tot.code_sale,2)}</td>
					</tr>
					<!--{ / }-->
					<!--{ ? orders.enuri > 0 }-->
					<tr>
						<th scope="row"><p>에누리</p></th>
						<td>{=get_currency_price(orders.enuri,2)}</td>
					</tr>
					<!--{ / }-->
				</tbody>
			</table>
		</div>
	</div>
	<div class="layer_bottom_btn_area2">
		<button type="button" class="btn_resp size_c color5 Wmax" onclick="hideCenterLayer()">확인</button>
	</div>
	<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
</div>

<!-- 증빙자료 신청 -->
<div id="saleslay" class="resp_layer_pop hide">
	<h4 class="title">증빙자료 신청</h4>
	<div class="y_scroll_auto">
		<div class="layer_pop_contents v3">
			<div class="hide">
				{? creceipt.tstep == 2 || tax.tstep == 2 //발급완료시 신청불가 }
					{? orders.typereceipt == 2 } 현금영수증
						<img src="../images/design/btn_print_receipt.gif" id="pgcashbtn{creceipt.tstep}" class="hand" sales_seq="{creceipt.seq}"  order_seq ="{orders.order_seq }" cash_no="{creceipt.cash_receipts_no}" settleprice="{orders.settleprice}" />
					{: orders.typereceipt == 1 } 세금계산서
					{:} 발급안함
					{/}
				{:}
					<label for="typereceipt0"><input type="radio" name="typereceipt" id="typereceipt0" value="0" checked="checked" /> 발급안함 </label>
					{ ? cfg_order.cashreceiptuse > 0 // 현금영수증 발행설정}
					<label for="typereceipt2">
					<input type="radio" name="typereceipt" id="typereceipt2" value="2" {? orders.typereceipt == 2 } checked="checked" {/}{? orders.cash_receipt_possible != 1} disabled{/}>
					현금영수증 </label>
					{ / }
					{ ? cfg_order.taxuse > 0 // 세금계산서 발행설정}
					<label for="typereceipt1">	<input type="radio" name="typereceipt" id="typereceipt1" value="1"  {? orders.typereceipt == 1 } checked="checked" {/}{? orders.tax_receipt_possible != 1} disabled{/}> 세금계산서 </label>
					{ / }
				{/}
			</div>
			<!-- ~~~~~~~ 현금영수증 신청 부분 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
			<div id="cash_container" class="{? !(cfg_order.cashreceiptuse > 0 && creceipt.seq && creceipt.tstep == 2) &&  orders.typereceipt != 2 }hide{/}">
			<form name="CreceiptForm" method="post" action="../sales_process/cashreceiptwrite" target="actionFrame">
				<input type="hidden" name="order_seq" value="{orders.order_seq}" />
				<input type="hidden" name="settleprice" value="{orders.settleprice}" />
				{? orders.typereceipt}
				<input type="hidden" name="creceipt_seq" value="{creceipt.seq}" />
				{/}
				<input type="hidden" name="goods_name" value="{creceipt.goods_name}" />
				<input type="hidden" name="order_user_name" value="{orders.order_user_name}" />
				<input type="hidden" name="order_step" value="{orders.step}" />
				<div class="resp_table_row input_form">
					<ul class="tr">
						<li class="th">발행용도</li>
						<li class="td label_group">
							{? creceipt.tstep == 2 }
								{? creceipt.cuse == 1 }
									개인 소득공제용
								{:}
									사업자 지출증빙용
								{/}
							{:}
							<label for="cuse0"><input type="radio" name="cuse"  id="cuse0" value="0" {? creceipt.cuse != 1 || !creceipt.seq} checked="checked" {/} /> 개인 소득공제</label>
							<label for="cuse1"><input type="radio" name="cuse"  id="cuse1" value="1" {? creceipt.cuse == 1 }checked="checked" {/}/> 사업자 지출증빙</label>
							{/}
						</li>
					</ul>
					<ul class="tr">
						<li class="th">인증번호</li>
						<li class="td">
							{? creceipt.tstep == 2 }
								{? creceipt.cuse == 1 }
								사업자번호 : {creceipt.creceipt_number}
								{:}
								휴대폰번호 : {creceipt.creceipt_number}
								{/}
							{:}
								<div id="personallay"  class="{? creceipt.cuse == 1 }hide{/}">
									<input type="tel" name="creceipt_number[0]" maxlength="13" value="{? creceipt.cuse == 0 }{creceipt.creceipt_number}{/}" title="휴대폰번호" /> <span class="res_st_desc2">"-" 없이 입력</span>
								</div>
								<div id="businesslay" class="{? creceipt.cuse != 1 }hide{/}" >
									 <input type="tel" name="creceipt_number[1]" maxlength="10" value="{? creceipt.cuse == 0 }{creceipt.creceipt_number}{/}" title="사업자번호" /> <span class="res_st_desc2">"-" 없이 입력</span>
								 </div>
							{/}
						</li>
					</ul>
					<ul class="tr">
						<li class="th">이메일주소</li>
						<li class="td">
							<div id="personallay">
								<input type="text" name="email" class="size_email_full" value="{creceipt.email}" title="이메일주소" />
							</div>
						</li>
					</ul>
				</div>
				{? creceipt.tstep != 2 }
				<div class="btn_area_b Pb5">
					<button type="submit" class="btn_resp size_c color2">{? creceipt.seq && orders.typereceipt}수정하기{:}신청하기{/}</button>
					<button type="button" class="btn_resp size_c" onclick="hideCenterLayer(); $('select[name=receipt_type]>option:eq(0)').prop('selected', true); $('#receipt_apply>option:eq(0)').prop('selected', true); $('#receipt_apply').hide();">취소</button>
				</div>
				{/}
			</form>
			</div>
			<!-- ~~~~~~~ 세금계산서 신청 부분 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
			<div id="tax_container" class="{? !(cfg_order.taxuse > 0 && tax.seq && tax.tstep == 2)  &&  orders.typereceipt != 1}hide{/}">
			<form name="TaxForm" method="post" action="../sales_process/taxwrite" target="actionFrame">
				<input type="hidden" name="order_seq" value="{orders.order_seq}" />
				<input type="hidden" name="settleprice" value="{orders.settleprice}" />
				<input type="hidden" name="tax_seq" value="{tax.seq}" />
				<input type="hidden" name="order_step" value="{orders.step}" />
				<div class="resp_table_row input_form">
					<ul class="tr">
						<li class="th">상호명</li>
						<li class="td"><input type="text" name="co_name" id="co_name" value="{? tax.seq}{tax.co_name}{:}{business_info.bname}{/}" title="상호명" /></li>
					</ul>
					<ul class="tr">
						<li class="th">사업자번호</li>
						<li class="td">
							<input type="text" name="busi_no" id="busi_no" value="{? tax.seq}{tax.busi_no}{:}{business_info.bno}{/}" title="사업자번호 " /> 
							<span class="res_st_desc2">ex)123-12-12345</span>
						</li>
					</ul>
					<ul class="tr">
						<li class="th">대표자</li>
						<li class="td"><input type="text" name="co_ceo" id="co_ceo" value="{? tax.seq}{tax.co_ceo}{:}{business_info.bCEO}{/}" title="대표자" /></li>
					</ul>
					<ul class="tr">
						<li class="th">업태</li>
						<li class="td">
							<input type="text" name="co_status" id="co_status" value="{? tax.seq}{tax.co_status}{:}{business_info.bstatus}{/}" title="업태" />
						</li>
					</ul>
					<ul class="tr">
						<li class="th">업종</li>
						<li class="td">
							<input type="text" name="co_type" id="co_type" value="{? tax.seq}{tax.co_type}{:}{business_info.bitem}{/}" title="업종" />
						</li>
					</ul>
					<ul class="tr">
						<li class="th">주소</li>
						<li class="td">
							<span id="PostNumberArea"><input type="text" name="new_zipcode" value="{? tax.seq}{tax.new_zipcode}{:}{business_info.co_new_zipcode}{/}" class="size_zip_all" title="우편번호" readonly /></span>
							<button type="button" class="btn_resp size_b color4" onclick="openDialogZipcode_resp('');">검색</button>
							<!--button type="button" class="btn_resp size_b color4" onclick="window.open('../popup/zipcode','popup_zipcode','width=500,height=350')">검색</button-->

							<input type="hidden" name="address_type" value="{? tax.seq}{tax.address_type}{:}{business_info.baddress_type}{/}" />
							<input type="text" name="address" id="address" class="size_address Mt5" {? tax.seq}{? tax.address_type == "street"}style="display:none;"{/}{:}{? business_info.baddress_type=='street' }style="display:none;"{/}{/} value="{? tax.seq}{tax.address}{:}{business_info.baddress1}{/}" title="기본주소" readonly />
							<input type="text" name="address_street" id="address_street" class="size_address Mt5" {? tax.seq}{? tax.address_type != "street"}style="display:none;"{/}{:}{? business_info.baddress_type!='street' }style="display:none;"{/}{/} value="{? tax.seq}{tax.address_street}{:}{business_info.baddress1}{/}" title="기본주소" readonly />

							<input type="text" name="address_detail" class="size_address Mt5" value="{? tax.seq}{tax.address_detail}{:}{business_info.baddress2}{/}" title="상세주소" />
						</li>
					</ul>
					<ul class="tr">
						<li class="th">담당자</li>
						<li class="td"><input type="text" name="person" id="person" value="{? tax.seq}{tax.person}{:}{business_info.bperson}{/}" title="담당자" /></li>
					</ul>
					<ul class="tr">
						<li class="th">이메일</li>
						<li class="td"><input type="text" name="email" id="email" value="{? tax.seq}{tax.email}{:}{members.email}{/}" title="이메일" /></li>
					</ul>
					<ul class="tr">
						<li class="th">연락처</li>
						<li class="td"><input type="text" name="phone" id="phone" value="{? tax.seq}{tax.phone}{:}{business_info.bphone}{/}" title="연락처" /></li>
					</ul>
				</div>

				{? tax.tstep != 2 }
				<div class="btn_area_b Pb5">
					<button type="submit" class="btn_resp size_c color2">{? tax.seq}수정하기{:}신청하기{/}</button>
					<button type="button" class="btn_resp size_c" onclick="hideCenterLayer(); $('select[name=receipt_type]>option:eq(0)').prop('selected', true); $('#receipt_apply>option:eq(0)').prop('selected', true); $('#receipt_apply').hide();">취소</button>
				</div>
				{/}
			</form>
			</div>
		</div>
	</div>
	<span class="btn_pop_close" onclick="hideCenterLayer(); $('select[name=receipt_type]>option:eq(0)').prop('selected', true); $('#receipt_apply>option:eq(0)').prop('selected', true); $('#receipt_apply').hide();"></span>
</div>

<!-- 구매 확정 및 마일리지/포인트 지급 -->
<div id="export_buy_confirm_msg" class="resp_layer_pop hide">
	<h4 class="title">구매 확정 및 마일리지/포인트 지급</h4>
	<div class="y_scroll_auto2">
		<div class="layer_pop_contents v5">
			<input type="hidden" name="export_code" value="" />
			<input type="hidden" name="status" value="" />
			<div class="Pt10 Pb10">
				구매 확정 및 마일리지/포인트 지급을 받으시기 전에 반드시 아래사항을 확인하여 주세요.<br />
				확인 버튼 클릭 시 구매 확정 및 마일리지/포인트가 지급됩니다.<br />
			</div>
			<ul class="list_dot_01 box Mt10 gray_05">
				<li>주문 상품을 수령하셨고, 고객 변심 및 착오에 의한  교환 또는 환불의 의사가 없으실 경우 확인해주세요. 확인 후 즉시 마일리지/포인트가 지급됩니다.</li>
				<li>동일 주문건의 상품 중 일부 만 교환 또는 반품을 원하실 경우 주문 번호 클릭 후 세부 주문내역에서  개별 상품에  대한 구매확정을 해주셔야 합니다.</li>
				<li>구매 확정으로 마일리지/포인트가 지급된 이후 또는 제품 착용 시  교환 또는 환불이 불가합니다.</li>
				{ ? cfg_order.save_type == 'exist' }
				<li>구매 확정을 하시지 않으시면 출고 완료 후  {cfg_order.save_term}일 후에는  자동으로 구매 확정 처리되지만 마일리지/포인트는 소멸됩니다.</li>
				{ : }
				<li>구매 확정을 하시지 않으시더라도 출고 완료 후  {cfg_order.save_term}일 후에는  자동으로 구매 확정 및 마일리지/포인트가 지급됩니다.</li>
				{ / }
			</ul>
			<ul class="export_buy_confirm_agree_container list_01 v2 C Pt15">
				<li>구매를 확정하기 위해 상품수령을 확인해 주세요.</li>
				<li class="Pt10 gray_01">
					<span class="pointcolor">상품을 수령하셨습니까?</span> &nbsp;
					<label><input type="radio" name="export_buy_confirm_agree" value="y" /> 예</label> &nbsp; &nbsp;
					<label><input type="radio" name="export_buy_confirm_agree" value="n" checked /> 아니오</label>
				</li>
			</ul>
		</div>
	</div>
	<div class="layer_bottom_btn_area2">
		<ul class="basic_btn_area2">
			<li><button type="button" id="export_buy_confirm_btn" class="btn_resp size_c color2 Wmax">구매확정</button></li>
			<li><button type="button" class="btn_resp size_c color5" onclick="hideCenterLayer()">취소</button></li>
		</ul>
	</div>
	<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
</div>


<!-- 티켓 사용 내역 조회 -->
<div id="coupon_use_lay" class="resp_layer_pop hide">
	<h4 class="title">티켓 사용 내역</h4>
	<div class="y_scroll_auto2">
		<div class="layer_pop_contents v5"></div>
	</div>
	<div class="layer_bottom_btn_area2">
		<button type="button" class="btn_resp size_c color5 Wmax" onclick="hideCenterLayer()">확인</button>
	</div>
	<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
</div>

<!-- 사은품 이벤트 정보 -->
<div id="gift_use_lay" class="resp_layer_pop hide">
	<h4 class="title">사은품 이벤트 정보</h4>
	<div class="y_scroll_auto2">
		<div class="layer_pop_contents v5"></div>
	</div>
	<div class="layer_bottom_btn_area2">
		<button type="button" class="btn_resp size_c color5 Wmax" onclick="hideCenterLayer()">확인</button>
	</div>
	<a href="javascript:void(0)" class="btn_pop_close" onclick="hideCenterLayer()"></a>
</div>
<div id="gift_use_lay"></div>

<!-- 교환 신청 (페이지 이동으로 처리) -->
<!--div id="order_refund_layer" class="hide"></div-->


<script type="text/javascript">
	var lately_msg_list = new Array();
	<!--{ ? lately_msg }-->
	<!--{ @ lately_msg }-->lately_msg_list[{.key_}] = "{.ship_message}";
	<!--{ / }-->
	<!--{ / }-->

	$(document).ready(function() {
		// 배송지 등록 / 수정 :: 2016-08-02 lwh
		$("select[name='select_address_group']").bind('change',function(){
			if($(this).val()==""){
				$("input[name='address_group']").val('').show();
			}else{
				$("input[name='address_group']").val($(this).val()).hide();
			}
		}).trigger('change');

		// 배송그룹 등록/수정 :: 2016-08-02 lwh
		$("#insert_address").bind("click",function(){
			var f = $("form#in_Address");
			f.attr("action","../mypage_process/delivery_address");
			f.attr("target","actionFrame");
			f[0].submit();
		});

		// 배송지 정보 채우기
		$("#copy_order_info").bind("click",function(){
			$("input[name='recipient_user_name']").val( $("input[name='order_user_name']").val() );

			$("input[name='order_phone[]']").each(function(idx){
				$("input[name='recipient_phone[]']").eq(idx).val( $("input[name='order_phone[]']").eq(idx).val() );
			});

			$("input[name='order_cellphone[]']").each(function(idx){
				$("input[name='recipient_cellphone[]']").eq(idx).val( $("input[name='order_cellphone[]']").eq(idx).val() );
			});

			$("input[name='recipient_email']").val( $("input[name='order_email']").val() );
		});
	});

	$(function(){
		{ ? pgCompany == 'allat' && orders.payment == 'card' && naxCheck == 'N' }
		const script = document.createElement("script");
		script.language = "JavaScript";
		script.charset = "utf-8";
		script.src = "https://tx.allatpay.com/common/AllatPayRE.js";
		document.head.appendChild(script);
		{ / }

		{ ? !items_tot.goodstotal || items_tot.goodstotal <= 0 }
		$(".goods_delivery_info").hide();
		{ / }

		//매출전표처리
		$("#pgreceiptbtn").click(function(){
			var tno= $(this).attr('tno');
			var shopid= '{pg.mallCode}';
			var ordno= $(this).attr('order_seq');
			var pg_kind = $(this).attr('pg_kind');
			var authdata= $(this).attr('authdata');
			var payment= '{orders.mpayment}';
			receiptView(tno, shopid, ordno, pg_kind, authdata, payment);
		});

		// 미신청시 UI처리
		$("#receipt_apply").change(function(){
			var value		= $(this).val();
			var tax_allow	= "{orders.sales_tax_allow}";
			if	(tax_allow == 'N') {
				// 환불신청 중입니다. 환불완료 후 세금계산서 신청해주세요.
				openDialogAlert(getAlert('mp233'),400,150,function(){ $("#receipt_apply > option[value=n]").attr("selected", true); });
				return false;
			}
			if	(value == 'y') {
				//매출증빙
				showCenterLayer('#saleslay')
				//openDialog(getAlert('mp120'), "saleslay", {"width":500,"height":400});
			}

			init_block_payco_cash_receip();
		});

		// 세금계산서 처리
		$("#taxcashbtn1").click(function(){
			var deposit = $(this).attr('deposit');

			if(deposit == 'n') {
				openDialogAlert(getAlert('mp215'),400,150,function(){ });
			} else {
				openDialogAlert(getAlert('mp218'),400,150,function(){ });
			}
		});

		$("#taxcashbtn4").click(function(){
			openDialogAlert(getAlert('mp216'),400,150,function(){ });
		});

		$("#taxcashbtn2").click(function(){
			var shopid= '{pg.mallCode}';
			var sales_seq	= $(this).attr('sales_seq');
			var order_seq	= $(this).attr('order_seq');
			var settleprice	= $(this).attr('settleprice');
			var cst_platform = '';

			$.ajax({
				'url' : '../mypage/tax_receipt_view',
				'data' : {'order_seq':order_seq,'seq':sales_seq},
				'type' : 'post',
				'dataType' : 'json',
				'success' : function(data) {
					if(data.tax_receipt_view) {
						$("#sales_tax_layer").html(data.tax_receipt_view);
						openDialog(getAlert('os237'), "sales_tax_layer", {"width":550,"height":500});
						setDefaultText();
					}
				}
			});
		});

		$(".taxCompleteOver").click(function(){
			openDialogAlert(getAlert('mp217'),400,140,function(){ });
		});

		// 현금영수증 처리
		$("#pgcashbtn1").click(function(){
			var deposit = $(this).attr('deposit');

			if(deposit == 'n') {
				openDialogAlert(getAlert('mp211'),400,150,function(){ });
			} else {
				openDialogAlert(getAlert('mp221'),400,150,function(){ });
			}
		});

		$("#pgcashbtn4").click(function(){
			openDialogAlert(getAlert('mp214'),400,150,function(){ });
		});

		$("#pgcashbtn2").click(function(){
			var cash_no= $(this).attr('cash_no');
			var shopid= '{pg.mallCode}';
			var ordno= $(this).attr('order_seq');
			var pg_kind = $(this).attr('pg_kind');
			var settleprice= $(this).attr('settleprice');
			var  tax_bank = '';
			var cst_platform = '';

			openDialogAlert(getAlert('mp184'),400,140,function(){

				if(pg_kind){
					if(pg_kind=="lg"){
						$.ajax({
							'url' : '../mypage_process/order_pg_info',
							'data' : {'order_seq':ordno},
							'type' : 'post',
							'dataType' : 'json',
							'success' : function(data) {
								if(data.result) {
									var  tax_bank = data.tax_bank;
									var cst_platform = data.cst_platform;
									cashView(cash_no, shopid, ordno, settleprice, tax_bank, cst_platform, pg_kind);
								}
							}
						});
					}else{
						var  tax_bank		= '';
						var cst_platform	= '';
						cashView(cash_no, shopid, ordno, settleprice, tax_bank, cst_platform, pg_kind);
					}
				}else{
					{? pgCompany == 'lg' }
						$.ajax({
							'url' : '../mypage_process/order_pg_info',
							'data' : {'order_seq':ordno},
							'type' : 'post',
							'dataType' : 'json',
							'success' : function(data) {
								if(data.result) {
									var  tax_bank = data.tax_bank;
									var cst_platform = data.cst_platform;
									cashView(cash_no, shopid, ordno, settleprice, tax_bank, cst_platform, pg_kind);
								}
							}
						});
					{:}
						var  tax_bank		= '';
						var cst_platform	= '';
						cashView(cash_no, shopid, ordno, settleprice, tax_bank, cst_platform, pg_kind);
					{/}
				}

			});
		});

		$(".completeOver").click(function(){
			openDialogAlert(getAlert('mp213'),400,140,function(){ });
		});

		$(".cancelBtn").click(function(){
			var order_seq = $(this).attr('order_seq');

			openDialogConfirm(getAlert('mp212'),400,140,function(){
				$.ajax({
					'url' : '../mypage_process/cancel_tax',
					'data' : {'order_seq':order_seq},
					'type' : 'post',
					'dataType' : 'json',
					'success' : function(data) {
						if(data.result) {
							openDialogAlert(getAlert('mp041'),400,150,function(){
								document.location.reload();
							});
						}
					}
				});
			},function(){ });
		});

		$('[name="receipt_type"]').change(function(){
			if ( $(this).val() == '' ) {
				$('#receipt_apply').hide();
				return false;
			} else {
				$('#receipt_apply').show();
			}

			var _index = $(this).find('option:selected').index(), v = $(this).val(), receipt_possible = $('[name="receipt_type"] option').eq(_index).attr('receipt_possible');

			$('#receipt_apply option:eq(0)').attr('selected', true);

			switch(v) {
				case 'tax':
					$('.receipt_date_limit').eq(0).show();
					$('.receipt_date_limit').eq(1).hide();

					$('#saleslay [name="typereceipt"]').attr('checked', false);
					$('#saleslay [name="typereceipt"]').eq(2).attr('checked', true);

					if(!receipt_possible) {
						$('#receipt_apply').attr('disabled', true).css({ background:'#dbdbdb' });
					} else {
						$('#receipt_apply').attr('disabled', false).css({ background:'' });
					}

					$('#saleslay #tax_container').show();
					$('#saleslay #cash_container').hide();
					break;
				case 'cash':
					$('.receipt_date_limit').eq(0).hide();
					$('.receipt_date_limit').eq(1).show();

					$('#saleslay [name="typereceipt"]').attr('checked', false);
					$('#saleslay [name="typereceipt"]').eq(1).attr('checked', true).focus();

					if(!receipt_possible) {
						$('#receipt_apply').attr('disabled', true).css({ background:'#dbdbdb' });
					} else {
						$('#receipt_apply').attr('disabled', false).css({ background:'' });
					}

					$('#saleslay #tax_container').hide();
					$('#saleslay #cash_container').show();
					break;
			}
		});

		// 영수증 발급을 클릭했을경우
		$("input:radio[name='typereceipt']").click(function() {
			// 발급안함
			if($(this).val() == 0) {
				$('#cash_container').hide();
				$('#tax_container').hide();
				taxRemoveClass();
				cashRemoveClass();
			}
			// 세금계산서 신청일 경우
			else if($(this).val() == 1) {
				$('#tax_container').show();
				$('#cash_container').hide();

				$('#co_name').attr('title', ' ').addClass('required');
				$('#co_ceo').attr('title', ' ').addClass('required');
				$('#busi_no').attr('title', ' ').addClass('required').addClass('busiNo');
				$('#co_zipcode').attr('title', ' ').addClass('required');
				$('#co_address').attr('title', ' ').addClass('required');
				$('#co_status').attr('title', ' ').addClass('required');
				$('#co_type').attr('title', ' ').addClass('required');

				cashRemoveClass();
			}
			// 현금영수증 신청일 경우
			else if($(this).val() == 2) {
				$('#cash_container').show();
				$('#tax_container').hide();
				$('#creceipt_number').attr('title', ' ').addClass('required').addClass('numberHyphen');
				taxRemoveClass();
			}
		});

		/**
		 * 세금계산서 폼체크를 삭제한다.
		 */
		function taxRemoveClass() {
			$('#co_name').removeClass('required');
			$('#co_ceo').removeClass('required');
			$('#busi_no').removeClass('required');
			$('#co_zipcode').removeClass('required');
			$('#co_address').removeClass('required');
			$('#co_status').removeClass('required');
			$('#co_type').removeClass('required');
		}

		/**
		 * 현금영수증 폼체크를 삭제한다.
		 */
		function cashRemoveClass() {
			$('#creceipt_number').removeClass('required');
		}

		//현금영수증 개인공제용
		$("#cuse0").click(function(){
			$("#personallay").show();
			$("#businesslay").hide();
		});

		//현금영수증 사업자지출증빙용
		$("#cuse1").click(function(){
			$("#personallay").hide();
			$("#businesslay").show();
		});

		$(".salesBtn").click(function(){
			//매출증빙
			openDialog(getAlert('mp120'), "saleslay", {"width":500,"height":400});
		});

		$(".exportbuyconfirm").live('click',function(){
			var export_code = $(this).attr('export_code');
			var status = $(this).attr('status');
			$("#export_buy_confirm_msg input[name='export_code']").val(export_code);
			$("#export_buy_confirm_msg input[name='status']").val(status);

			if(status!='75'){
				$(".export_buy_confirm_agree_container").show();
			}else{
				$(".export_buy_confirm_agree_container").hide();
			}

			// 배송완료 전이면 수령확인 메시지
			//구매 확정 및 마일리지/포인트 지급
			showCenterLayer('#export_buy_confirm_msg');
			//openDialog(getAlert('mp121'), "#export_buy_confirm_msg",{"width":550});
		});

		$("#export_buy_confirm_btn").live("click",function(){
			var ret = false;
			var export_code = $("#export_buy_confirm_msg input[name='export_code']").val();
			var status = $("#export_buy_confirm_msg input[name='status']").val();

			if(status!='75'){
				if(!$("input[name='export_buy_confirm_agree'][value='y']").is(":checked")){
					//상품수령여부에 체크해주세요.
					openDialogAlert(getAlert('mp129'),'450','140',function(){
						$("input[name='export_buy_confirm_agree']").eq(0).focus();
					});
					return;
				}
			}
			hideCenterLayer('#export_buy_confirm_msg');
			//closeDialog("#export_buy_confirm_msg");
			export_buy_confirm(export_code);
		});

		$(".price_area").bind("mouseover",function(){
			$(this).parent().find(".sale_price_layer").show();
		}).bind("mouseout",function(){
			$(this).parent().find(".sale_price_layer").hide();
		});

		// 사은품 지급 조건 상세
		$(".gift_log").bind('click', function(){
			$.ajax({
				type: "post",
				url: "./gift_use_log",
				data: "order_seq="+$(this).attr('order_seq')+"&item_seq="+$(this).attr('item_seq'),
				success: function(result){
					if	(result){
						$("#gift_use_lay .layer_pop_contents").html(result);
						//사은품 이벤트 정보
						showCenterLayer('#gift_use_lay');
						//openDialog(getAlert('mp122'), "gift_use_lay", {"width":"450","height":"220"});
					}
				}
			});
		});

		$(".sale").bind("mouseover",function(){
			$(this).closest('td').find('div').removeClass('hide');
		}).bind("mouseout",function(){
			$(this).closest('td').find('div').addClass('hide');
		});

		/* 토글 레이어 */
		$(".detailDescriptionLayerBtn").click(function(){
			$('div.detailDescriptionLayer').not($(this).siblings('div.detailDescriptionLayer')).hide();
			$(this).siblings('div.detailDescriptionLayer').toggle();
		});
		$(".detailDescriptionLayerCloseBtn").click(function(){
			$(this).closest('div.detailDescriptionLayer').hide();
		});
	});

	// 쿠폰 사용내역 조회
	function coupon_history(exportCode,serial){
		$("#coupon_use_lay .layer_pop_contents").html('');
		$.ajax({
			type: "get",
			url: "./coupon_view?code="+exportCode+"&scode="+serial+"&popup=1",
			data: "code="+exportCode,
			success: function(result){
				if	(result.search(/error\:/) != -1){
					openDialogAlert(result.replace('error:', ''), 400, 150);
				}else{
					$("#coupon_use_lay .layer_pop_contents").html(result);
					showCenterLayer('#coupon_use_lay');
					//openDialog(getAlert('mp123')+' - <span class="desc" style="color:#0083a9" >'+serial+'</span>', "#coupon_use_lay", {"width":"500","height":"550"});
				}
			}
		});
	}

	// 쿠폰 사용하기
	function coupon_use(exportCode,serial){
		if ( window.innerWidth > 767 ) {
			window.open("./coupon_use?code="+exportCode+"&scode="+serial+"&popup=1",'coupon_use', 'width=500, height=600, top=100, left=100, fullscreen=no, menubar=no, status=no, toolbar=no, titlebar=yes, location=yes, scrollbar=yes');
		} else {
			window.open("./coupon_use?code="+exportCode+"&scode="+serial+"&popup=1", "_blank");
		}
	}

	//구매확정처리
	function export_buy_confirm(export_code){
		$.ajax({
			'url' : '../mypage_process/buy_confirm',
			'data' : {'export_code':export_code},
			'type' : 'get',
			'dataType' : 'json',
			'success' : function(data) {
				if(data.result) {
					openDialogAlert(data.msg,'450','200',function(){document.location.reload();});
				}else if(data.msg){
					openDialogAlert(data.msg,'450','200');
				}
			}
		});
	}

	function goods_review_write(goodsseq,order_seq){
		if(goodsseq){
			{ ? defined('__ISUSER__') }
				location.href = '/mypage/mygdreview_write?goods_seq='+goodsseq+'&order_seq='+order_seq;
			{:}
				location.href = '/board/write?id=goods_review&goods_seq='+goodsseq+'&order_seq='+order_seq;
			{/}
		}
	}

	function order_cancel(order_seq){
		//주문을 무효처리 합니다.
		if(confirm(getAlert('mp124')))
		{
			actionFrame.location.href = '../mypage_process/cancel?order_seq={orders.order_seq}';
		}
	}

	function order_refund(order_seq){
		location.href='/mypage/order_refund?order_seq=' + order_seq + '&use_layout=1';
	}

	function order_return_coupon(order_seq){
		location.href='/mypage/order_return?mode=return_coupon&order_seq=' + order_seq + '&type=return&use_layout=1';
	}

	function order_return(order_seq){
		location.href='/mypage/order_return?order_seq=' + order_seq + '&type=return&use_layout=1';
	}

	function order_exchange(order_seq){
		location.href='/mypage/order_return?mode=exchange&order_seq=' + order_seq + '&type=exchange&use_layout=1';
	}

	//매출전표 처리
	function receiptView(tno, shopid, ordno, pg_kind, authdata, payment) {
		if(pg_kind){
			if(pg_kind=='kcp'){
				if(payment == "cellphone"){
					receiptWin = "https://admin8.kcp.co.kr/assist/bill.BillAction.do?cmd=mcash_bill&h_trade_no=" + tno;
				}else if(payment == "virtual"){
					receiptWin = "https://admin8.kcp.co.kr/assist/bill.BillAction.do?cmd=vcnt_bill&a_trade_no=" + tno;
				}else if(payment == "account"){
					receiptWin = "https://admin8.kcp.co.kr/assist/bill.BillAction.do?cmd=acnt_bill&h_trade_no=" + tno;
				}else{
					receiptWin = "https://admin.kcp.co.kr/Modules/Sale/Card/ADSA_CARD_BILL_Receipt.jsp?c_trade_no=" + tno;
				}
				window.open(receiptWin , "" , "width=450,height=800,scrollbars=yes");
			}else if(pg_kind=='inicis'){
				receiptWin = "https://iniweb.inicis.com/DefaultWebApp/mall/cr/cm/mCmReceipt_head.jsp?noTid="+ tno + "&noMethod=1";
				window.open(receiptWin , "" , "width=410,height=715, scrollbars=no,resizable=no");
			}else if(pg_kind=='lg'){
				showReceiptByTID(shopid, tno, authdata);
			}else if(pg_kind=='allat'){
				var allat_urls = "https://www.allatpay.com/servlet/AllatBizPop/member/pop_card_receipt.jsp?tx_seq_no="+tno+"&order_no="+ordno;
				window.open(allat_urls,"app","width=410,height=650,scrollbars=0");
			}else if(pg_kind=='kspay'){
				var allat_urls = "https://nims.ksnet.co.kr/pg_infoc/src/bill/credit_view_print.jsp?tr_no="+tno;
				window.open(allat_urls,"app","width=456,height=700,scrollbars=1");
			}else if(pg_kind=='kakaopay'){
				var status = "toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,width=550,height=540";
				$.get('/kakaopay/pg_confirm?no='+ordno+'&tno='+tno, function(data) {
					var url = data;
					window.open(url,"popupIssue",status);
				});
			}else if(pg_kind=='kicc'){
				var status = "toolbar=0,scroll=1,menubar=0,status=0,resizable=0,width=380,height=700";
				$.get('/kicc/receipt?no='+ordno, function(data) {
					var url = data;
					if(url!='false'){
						window.open(url,"popupIssue",status);
					}else{
						alert('매출증빙 요청 정보가 올바르지 않습니다.');
					}
				});
			}else if(pg_kind=='payco'){
				var status = "toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,width=550,height=540";
				$.get('/payco/pg_confirm?no='+ordno, function(data) {
					var url = data;
					window.open(url,"popupIssue",status);
				});
			}
		}else{
			{? pgCompany == 'kcp'}
				if(payment == "cellphone"){
					receiptWin = "https://admin8.kcp.co.kr/assist/bill.BillAction.do?cmd=mcash_bill&h_trade_no=" + tno;
				}else if(payment == "virtual"){
					receiptWin = "https://admin8.kcp.co.kr/assist/bill.BillAction.do?cmd=vcnt_bill&a_trade_no=" + tno;
				}else if(payment == "account"){
					receiptWin = "https://admin8.kcp.co.kr/assist/bill.BillAction.do?cmd=acnt_bill&h_trade_no=" + tno;
				}else{
					receiptWin = "https://admin.kcp.co.kr/Modules/Sale/Card/ADSA_CARD_BILL_Receipt.jsp?c_trade_no=" + tno;
				}
				window.open(receiptWin , "" , "width=450, height=800");
			{: pgCompany == 'inicis' }
				receiptWin = "https://iniweb.inicis.com/DefaultWebApp/mall/cr/cm/mCmReceipt_head.jsp?noTid="+ tno + "&noMethod=1";
				window.open(receiptWin , "" , "width=410,height=715, scrollbars=no,resizable=no");
			{: pgCompany == 'lg' }
				showReceiptByTID(shopid, tno, authdata);
			{: pgCompany == 'allat' }
				var allat_urls = "https://www.allatpay.com/servlet/AllatBizPop/member/pop_card_receipt.jsp?tx_seq_no="+tno+"&order_no="+ordno;
				window.open(allat_urls,"app","width=410,height=650,scrollbars=0");
			{: pgCompany == 'kspay' }
				var allat_urls = "https://nims.ksnet.co.kr/pg_infoc/src/bill/credit_view_print.jsp?tr_no="+tno;
				window.open(allat_urls,"app","width=456,height=700,scrollbars=1");
			{: pgCompany == 'kicc' }
				var status = "toolbar=0,scroll=1,menubar=0,status=0,resizable=0,width=380,height=700";
				$.get('/kicc/receipt?no='+ordno, function(data) {
					var url = data;
					if(url!='false'){
						window.open(url,"popupIssue",status);
					}else{
						alert('매출증빙 요청 정보가 올바르지 않습니다.');
					}
				});
			{ / }
		}
	}

	//현금영수증처리
	function cashView(cash_no, shopid, ordno, settleprice, tax_bank, cst_platform, pg_kind)	{
		if(pg_kind){
			if(pg_kind=="kcp"){
				receiptWin = receiptWin = "https://admin.kcp.co.kr/Modules/Service/Cash/Cash_Bill_Common_View.jsp?cash_no="+cash_no;
					window.open(receiptWin , "" , "width=360, height=647");
			}else if(pg_kind=="inicis"){
				showreceiptUrl = "https://iniweb.inicis.com/DefaultWebApp/mall/cr/cm/Cash_mCmReceipt.jsp?noTid="+ cash_no + "&clpaymethod=22";
					window.open(showreceiptUrl,"showreceipt","width=380,height=540, scrollbars=no,resizable=no");
			}else if(pg_kind=="lg"){
				showCashReceipts(shopid, ordno, '01', tax_bank, cst_platform);
			}else if(pg_kind=="allat"){
				var cash_no = cash_no.replace( /(^\s*)|(\s*$)/g, "" );
					var urls ="https://www.allatpay.com/servlet/AllatBizPop/member/pop_cash_receipt.jsp?receipt_seq_no="+ cash_no + "&shop_id="+shopid+"&amt="+settleprice;
					window.open(urls,"app","width=410,height=650,scrollbars=0");
			}else if(pg_kind=="kspay"){
				showreceiptUrl = "https://nims.ksnet.co.kr/pg_infoc/src/bill/ps2.jsp?s_pg_deal_numb="+cash_no;
					window.open(showreceiptUrl ,"showreceipt","width=435, height=540");
			}else if(pg_kind=='kicc'){
				var status = "toolbar=0,scroll=1,menubar=0,status=0,resizable=0,width=380,height=700";
				$.get('/kicc/receipt?no='+ordno, function(data) {
					var url = data;
					if(url!='false'){
						window.open(url,"popupIssue",status);
					}else{
						alert('매출증빙 요청 정보가 올바르지 않습니다.');
					}
				});
			}
		}else{
			{? pgCompany === "kcp"}
					receiptWin = receiptWin = "https://admin.kcp.co.kr/Modules/Service/Cash/Cash_Bill_Common_View.jsp?cash_no="+cash_no;
					window.open(receiptWin , "" , "width=360, height=647");
			{ : pgCompany === "inicis" }
					showreceiptUrl = "https://iniweb.inicis.com/DefaultWebApp/mall/cr/cm/Cash_mCmReceipt.jsp?noTid="+ cash_no + "&clpaymethod=22";
					window.open(showreceiptUrl,"showreceipt","width=380,height=540, scrollbars=no,resizable=no");
			{ : pgCompany == 'lg' }
					showCashReceipts(shopid, ordno, '01', tax_bank, cst_platform);
			{ : pgCompany == 'allat' }
					var cash_no = cash_no.replace( /(^\s*)|(\s*$)/g, "" );
					var urls ="https://www.allatpay.com/servlet/AllatBizPop/member/pop_cash_receipt.jsp?receipt_seq_no="+ cash_no + "&shop_id="+shopid+"&amt="+settleprice;
					window.open(urls,"app","width=410,height=650,scrollbars=0");
			{ : pgCompany == 'kspay' }
					showreceiptUrl = "https://nims.ksnet.co.kr/pg_infoc/src/bill/ps2.jsp?s_pg_deal_numb="+cash_no;
					window.open(showreceiptUrl ,"showreceipt","width=435, height=540");
			{: pgCompany == 'kicc' }
				var status = "toolbar=0,scroll=1,menubar=0,status=0,resizable=0,width=380,height=700";
				$.get('/kicc/receipt?no='+ordno, function(data) {
					var url = data;
					if(url!='false'){
						window.open(url,"popupIssue",status);
					}else{
						alert('매출증빙 요청 정보가 올바르지 않습니다.');
					}
				});
			{ / }
		}
	}

	function taxlayerclose(){
		hideCenterLayer('#saleslay');
		//$('#saleslay').dialog('close');
	}

	/**
	 * 배송메시지
	*/
	$(function(){
		// 초기 모든 배송메세지 길이 체크
		$('.ship-lay').each(function(){
			var obj = $(this);
			check_ship_message_length(obj);
		});
	});

	for(var i=0; i< lately_msg_list.length; i++){
		$(".add_message").append("<li>(최근) "+lately_msg_list[i]+"</li>");
	}

	$("#shipMessage .ship_message_txt").on('focus', function(){
		if($(this).closest(".ship_message").find(".add_message").css("display")=='none'){
			$(".add_message").hide();
			$(this).closest(".ship_message").find(".add_message").show();
		}else{
			$(".add_message").hide();
			$(this).closest(".ship_message").find(".add_message").hide();
		}
	});
	$("#shipMessage .ship_message_txt").on('blur', function(){
		$(".add_message").hide();
	});
	$(".add_message>li").on("mousedown", function(){
		var sel_message = $(this).html();
		sel_message = sel_message.replace('(최근) ','');
		$(this).closest(".ship_message").find(".ship_message_txt").val(sel_message).trigger('change');
		$(".add_message").hide();
	});

	// 배송메세지 카운터
	$(".ship_message_txt").bind("keyup change", function(){
		var obj = $(this).closest(".ship-lay");
		check_ship_message_length(obj);
	});

	// 배송메세지 길이 체크
	function check_ship_message_length(obj){
		var message		= obj.find(".ship_message_txt").val();
		var message_cnt	= message.length;
		if(message_cnt <= 300){
			obj.find(".cnt_txt").html(message_cnt);
		}else{
			//배송메세지는 300자 이하까지만 가능합니다.
			alert(getAlert('os151'));
			obj.find(".cnt_txt").html(300);
			obj.find(".ship_message_txt").val(message.substr(0,300));
		}
	}

	// 배송지 수정 완료
	function callback_recipient() {
		//var elem = $('.order_settle .benefit'), f = {}, form = $('form[name="recipient"]', elem), buff = form.serializeArray();
		var elem = $('.orderSettle'), f = {}, form = $('form[name="recipient"]', elem), buff = form.serializeArray();

		$.each(buff, function(k, v){
			f[v.name] = v.value;
		});

		// 개별 가져오기
		f.recipient_cellphone = '';
		$('[name="recipient_cellphone[]"]', form).each(function(){
			f.recipient_cellphone += (f.recipient_cellphone ? '-' : '') + $(this).val();
		});

		f.recipient_phone = '';
		$('[name="recipient_phone[]"]', form).each(function(){
			f.recipient_phone += (f.recipient_phone ? '-' : '') + $(this).val();
		});

		$('.recipient_user_name', elem).html(f.recipient_user_name);
		$('.recipient_zipcode', elem).html(f.recipient_new_zipcode);
		$('.recipient_address', elem).html(f.recipient_address);
		$('.recipient_address_street', elem).html(f.recipient_address_street);
		$('.recipient_address_detail', elem).html(f.recipient_address_detail);
		$('.recipient_cellphone', elem).html(f.recipient_cellphone);
		$('.recipient_phone', elem).html(f.recipient_phone);
		$('.recipient_email', elem).html(f.recipient_email);
		$('.recipient_ship_message', elem).html(f.memo);
		$('.international_address', elem).html(f.international_address);
		$('.international_country', elem).html(f.international_country);
		$('.international_county', elem).html(f.international_county);
		$('.international_postcode', elem).html(f.international_postcode);
		$('.international_town_city', elem).html(f.international_town_city);
		$('.clearance_unique_personal_code', elem).html(f.clearance_unique_personal_code);

		// 상품별 배송메세지
		$('#edit_address_wrap .ship_message_txt', elem).each(function(){
			var index = $('#edit_address_wrap .ship_message_txt', elem).index($(this)), ship_message = $(this).val();
			$('#view_address_wrap .recipient_ship_messages', elem).eq(index).text(ship_message);
		});

		// visible sw
		f.recipient_phone ? $('.recipient_phone', elem).show() : $('.recipient_phone', elem).hide();
		f.recipient_email ? $('.recipient_email', elem).show() : $('.recipient_email', elem).hide();
		f.memo ? $('.recipient_ship_message', elem).parents('li').show() : $('.recipient_ship_message', elem).parents('li').hide();

		mode_change('address_wrap', 'view');
	}

	// 배송주소록 팝업 창 :: 2016-08-02 lwh
	function popDeliveryaddress(page){
		var member_seq = $("input[name='member_seq']").val(), international = $("input[name='international']").val();
		$.ajax({
			'url'	: '/order/pop_delivery_address',
			'data'	: {'page':page,'member_seq':member_seq, 'international': international},
			'type'	: 'get',
			'dataType': 'text',
			'success': function(html) {
				if(html){
					//$("#delivery_address_dialog").html(html);
					$("#delivery_address_dialog .layer_pop_contents").html(html);
					if(page != 'reload'){
						//주소록
						//openDialog(getAlert('os185'), "delivery_address_dialog", {"width":730,"height":480});
						showCenterLayer('#delivery_address_dialog');
					}
				}else{
					//주소록을 로드하지 못했습니다.
					alert(getAlert('os182'));
					document.location.reload();
				}
			}
		});
	}

	// 배송지 수정 등록 용 국가변경 :: 2016-08-03 lwh
	function chg_address_nation(obj){
		var sel_nation = $(obj).val();
		if(sel_nation == 'KOREA'){
			$("#inAddress").find(".domestic").show();
			$("#inAddress").find(".international").hide();
		}else{
			$("#inAddress").find(".domestic").hide();
			$("#inAddress").find(".international").show();
		}
	}

	// 추가연락처
	function add_phone(obj, type){
		if			(type == 'open'){
			$(obj).closest('li').next('.add_phone').show();
			$(obj).attr('onclick',"add_phone(this,'close')");
			$(obj).html('추가연락처 ▲');
		}else if	(type == 'close'){
			$(obj).closest('li').next('.add_phone').hide();
			$(obj).attr('onclick',"add_phone(this,'open')");
			$(obj).html('추가연락처 ▼');
		}else{ // 체크하여 값이 있으면 열기
			var add_phone_flag = true;
			$(obj).closest('li').next('.add_phone').find('input.add_phone_input').each(function(){
				if (!$(this).val())	add_phone_flag = false;
			});

			if(add_phone_flag){
				$(obj).closest('li').next('.add_phone').show();
				$(obj).attr('onclick',"add_phone(this,'close')");
				$(obj).html('추가연락처 ▲');
			}
		}
	}

	// PC용 주소지정 - 주소록 지정 / 배송지 선택지정
	function set_address(addr){
		if(addr == 'new'){ // 신규 배송지
			$("input[name='recipient_new_zipcode']").val('');
			$("input[name='recipient_address_type']").val('');
			$("input[name='recipient_address']").val('');
			$("input[name='recipient_address_street']").val('');
			$("input[name='recipient_address_detail']").val('');
			$("input[name='recipient_user_name']").val('');
			$("input[name='international_address']").val('');
			$("input[name='international_town_city']").val('');
			$("input[name='international_county']").val('');
			$("input[name='international_postcode']").val('');
			$("input[name='recipient_phone[]']").each(function(idx){
				$("input[name='recipient_phone[]']").eq(idx).val("");
			});
			$("input[name='recipient_cellphone[]']").each(function(idx){
				$("input[name='recipient_cellphone[]']").eq(idx).val("");
			});
			$("input[name='recipient_email']").val('');
			$(".international").hide();
			if(!$("#address_nation").val()){
				$("#address_nation").val('KOREA').trigger('change');
			}
			set_shipping('input');
		}else if(addr == 'modify'){
			$(".delivery_member").hide();
			$(".international").hide();
			$("#address_nation").val('KOREA').trigger('change');
		}else{
			var is_error = false;

			$(".kr_zipcode").show();
			if(addr.nation == 'KOREA' || addr.international == 'domestic'){
				// apply
				$.ajax({
					type: "POST",
					method: "POST",
					url: "../mypage_process/recipient",
					data: {
						"mode" : "json",
						"order_seq":"{orders.order_seq}",
						"international":"domestic",
						"recipient_user_name":addr.recipient_user_name,
						"region":addr.region,
						"recipient_new_zipcode":addr.recipient_new_zipcode,
						"recipient_address":addr.recipient_address,
						"recipient_address_street":addr.recipient_address_street,
						"recipient_address_detail":addr.recipient_address_detail,
						"recipient_address_type":addr.recipient_address_type,
						"recipient_cellphone":addr.recipient_cellphone,
						"recipient_phone":addr.recipient_phone,
						"recipient_email":addr.recipient_email
					},
					dataType: "json",
					async: false
				})
				.done(function(data){
					switch(data.state) {
						case '999':
							data.error_message && openDialogAlert(data.error_message, 400, 150);
							data.location && (location.href = data.location);
							is_error = true;
							break;
						default:

					}
				});

				if(is_error) {
					return false;
				}

				// input values
				$("#international").val('0');
				$(".kr_zipcode").show();
				$("input[name='international']").val('domestic');
				$("input[name='address_description']").val(addr.address_description);
				$("input[name='recipient_user_name']").val(addr.recipient_user_name);
				$("input[name='recipient_address_type']").val(addr.recipient_address_type);
				$("input[name='recipient_address']").val(addr.recipient_address);
				$("input[name='recipient_address_street']").val(addr.recipient_address_street);
				$("input[name='recipient_address_detail']").val(addr.recipient_address_detail);
				$("input[name='recipient_new_zipcode']").eq(0).val(addr.recipient_new_zipcode);
				$("input[name='recipient_email']").val(addr.recipient_email);
				if (addr.recipient_phone != null) {
					$("input[name='recipient_phone[]']").each(function(idx){
						$(this).val( addr.recipient_phone.split('-')[idx] );
					});
				}
				if (addr.recipient_cellphone != null) {
					$("input[name='recipient_cellphone[]']").each(function(idx){
						$(this).val( addr.recipient_cellphone.split('-')[idx] );
					});
				}

				// span values
				if(addr.recipient_user_name)
						$(".recipient_user_name").html(addr.recipient_user_name);
				else	$(".recipient_user_name").html('받는분 없음');

				if(addr.recipient_new_zipcode){
					$(".recipient_zipcode").html(addr.recipient_new_zipcode);
					$(".recipient_address_street").html(addr.recipient_address_street);
					$(".recipient_address").html(addr.recipient_address);
					$(".recipient_address_detail").html(addr.recipient_address_detail);
				}else{
					$(".kr_zipcode").hide();
					$(".recipient_address").html('배송주소 없음');
				}

				if(addr.recipient_cellphone)
						$(".cellphone").html(addr.recipient_cellphone);
				else	$(".cellphone").html('휴대폰번호 없음');

				if(addr.recipient_phone)
						$(".phone").html(addr.recipient_phone);
				else	$(".phone").html('추가연락처 없음');

				$(".international_nation").html('대한민국');
				$("#address_nation").val('KOREA').trigger('change');

				// 국내 ON, 해외 OFF
				$('#view_address_wrap .domestic').show();
				$('#view_address_wrap .international').hide();
				$('#edit_address_wrap .domestic').show();
				$('#edit_address_wrap .international').hide();
				$('#edit_address_wrap .domestic input').attr('disabled', false);
				$('#edit_address_wrap .international input').attr('disabled', true);
			}else{
				// apply
				$.ajax({
					type: "POST",
					method: "POST",
					url: "../mypage_process/recipient",
					data: {
						"mode" : "json",
						"order_seq":"{orders.order_seq}",
						"international":"international",
						"recipient_user_name":addr.recipient_user_name,
						"region":addr.region,
						"international_address":addr.international_address,
						"international_town_city":addr.international_town_city,
						"international_county":addr.international_county,
						"international_postcode":addr.international_postcode,
						"international_country":addr.international_country,
						"recipient_cellphone":addr.recipient_cellphone,
						"recipient_phone":addr.recipient_phone,
						"recipient_email":addr.recipient_email
					},
					dataType: "json",
					async: false
				})
				.done(function(data){
					switch(data.state) {
						case '999':
							data.error_message && openDialogAlert(data.error_message, 400, 150);
							data.location && (location.href = data.location);
							is_error = true;
							break;
						default:

					}
				});

				if(is_error) {
					return false;
				}

				// input values
				$("#international").val('1');
				$(".kr_zipcode").hide();
				$("input[name='international']").val('international');
				$("input[name='address_description']").val(addr.address_description);
				$("input[name='recipient_user_name']").val(addr.recipient_user_name);
				$("select[name='region']").val(addr.region);
				$("input[name='international_county']").val(addr.international_county);
				$("input[name='international_address']").val(addr.international_address);
				$("input[name='international_town_city']").val(addr.international_town_city);
				$("input[name='international_postcode']").val(addr.international_postcode);
				$("input[name='international_country']").val(addr.international_country);
				$("input[name='recipient_email']").val(addr.recipient_email);
				if (addr.recipient_phone != null) {
					$("input[name='recipient_phone[]']").each(function(idx){
						$(this).val( addr.recipient_phone.split('-')[idx] );
					});
				}
				if (addr.recipient_cellphone != null) {
					$("input[name='recipient_cellphone[]']").each(function(idx){
						$(this).val( addr.recipient_cellphone.split('-')[idx] );
					});
				}

				// span values
				$(".recipient_user_name").html(addr.recipient_user_name);
				$(".international_address").html(addr.international_address);
				$(".international_town_city").html(addr.international_town_city);
				$(".international_county").html(addr.international_county);
				$(".international_country").html(addr.international_country);
				addr.recipient_cellphone && addr.recipient_cellphone != '--' ? $(".recipient_cellphone").html(addr.recipient_cellphone).show() : $(".recipient_cellphone").hide();
				addr.recipient_phone && addr.recipient_phone != '--' ? $(".recipient_phone").html((addr.recipient_cellphone && addr.recipient_phone ? ' / ' : '') + addr.recipient_phone).show() : $(".recipient_phone").hide();
				$(".recipient_email").html(addr.recipient_email);
				$(".international_nation").html(addr.nation);
				$(".nation_name").html(addr.nation.replace(/^([가-힣.]+) \([a-z.]+\)/i, '$1'));
				$("#address_nation").val(addr.nation).trigger('change');

				// 국내 OFF, 해외 ON
				$('#view_address_wrap .domestic').hide();
				$('#view_address_wrap .international').show();
				$('#edit_address_wrap .domestic').hide();
				$('#edit_address_wrap .international').show();
				$('#edit_address_wrap .domestic input').attr('disabled', true);
				$('#edit_address_wrap .international input').attr('disabled', false);
			} // end nation if

			if(addr.recipient_email) $(".recipient_email").html(addr.recipient_email);
			else	$(".recipient_email").html('이메일주소 없음');

			set_shipping('view');

			openDialogAlert("배송지가 변경되었습니다.", 400, 150);
		} // end address if
	}

	// 배송 view 결정 - 필수 배송호출 :: 2017-05-15 lwh
	function set_shipping(type){

		// 각 타입별 배송지 view
		$(".direct_store_info").hide();
		$(".coupon_delivery_info").hide();
		if(typeof(is_goods)!='undefined' && is_goods)
			$(".goods_delivery_info").show();
		if(typeof(is_direct_store)!='undefined' && is_direct_store)
			$(".direct_store_info").show();
		if(typeof(is_coupon)!='undefined' && is_coupon)
			$(".coupon_delivery_info").show();

		// 입력 또는 view 결정
		if(type == 'view'){
			$(".delivery_member").show();
		}else{
			$(".delivery_member").hide();
		}

		// 국가별 결정
		var international = $("#address_nation").val();
		if(international == 'KOREA'){
			$(".international").hide();
		}else{
			$(".domestic").hide();
		}
	}

	function mode_change(wrap_id, mode) {
		if(!wrap_id) return false;

		var edit_wrap_id = 'edit_' + wrap_id,
			 view_wrap_id = 'view_' + wrap_id,
			 international = $('#view_address_wrap [name="international"]').val();
			 address_nation = $('#view_address_wrap [name="address_nation"]').val();

		switch(mode) {
			case 'edit':
				openDialogAlert(getAlert('mo145'),400,140,function(){
					// 국가체크해서 입력폼 활성
					if(international == 'domestic' || address_nation == 'KOREA') {
						$('#edit_address_wrap .domestic').show();
						$('#edit_address_wrap .international').hide();
						$('#edit_address_wrap .domestic input').attr('disabled', false);
						$('#edit_address_wrap .international input').attr('disabled', true);
					} else {
						$('#edit_address_wrap .domestic').hide();
						$('#edit_address_wrap .international').show();
						$('#edit_address_wrap .domestic input').attr('disabled', true);
						$('#edit_address_wrap .international input').attr('disabled', false);
					}

					//$('#'+edit_wrap_id).show();
					//$('#'+view_wrap_id).hide();
					showCenterLayer('#' + edit_wrap_id);

				});
				break;
			case 'view':
				//$('#'+edit_wrap_id).hide();
				//$('#'+view_wrap_id).show();
				hideCenterLayer('#' + edit_wrap_id);
				break;
		}
	}

	// 페이코의 경우 현금 영수증 신청 불가능하도록 처리
    function init_block_payco_cash_receip(){
        var receipt_type = $("select[name='receipt_type']");
        var receipt_apply = $("#receipt_apply");
        var typereceipt = $("input:radio[name='typereceipt']:checked");
        
        // 페이코일때 현금영수증을 신청하려는 경우
        if('{=orders.pg}'=='payco' // 페이코인경우
        //    && (    // 선택 조건과 상관 없이 페이코의 경우 세금계산서, 현금영수증을 신청할 수 없음.
        //        (receipt_type.val() == 'cash' &&  receipt_apply.val() == 'y') // 셀렉트에서 선택 시
        //        || (typereceipt.val() == '2')    // 팝업에서 선택 시
        //    )
        ){
            // 선택 조건 초기화
            receipt_type.val('tax');
            receipt_apply.val('n');
            // receipt_type.trigger('change');
            alert('페이코 간편결제로 결제하신 주문의 세금 계산서 및 현금 영수증은 페이코 사이트에서 발급할 수 있습니다.');
            // 레이어 닫기
            taxlayerclose();
        }
    }
//-->
</script>


<!-- 배송지등록 / 수정 :: START -->
<!-- 주문/배송 상세에서는 배송 주소록 가져오지 않는 것으로 처리함 (통신 에러남) -->
<div id="inAddress" class="hide">
	<form id="in_Address" method="post" >
	<input type="hidden" name="insert_mode" />
	<input type="hidden" name="page_type" value="order" />
	<input type="hidden" name="address_seq" />
	<div>- 자주쓰는 배송지는 최대 30개까지 등록할 수 있습니다.</div>
	<table width="100%" class="info_table_style mt10" border="0" cellpadding="5" cellspacing="0">
		<colgroup>
			<col width="90" />
			<col />
		</colgroup>
		<tbody>
			<tr >
				<th scope="row">그룹</th>
				<td>
					<select name="select_address_group">
					<!--{ @ arr_address_group }-->
						<!--{ ? .address_group }-->
						<option value="{.address_group}">{.address_group}</option>
						<!--{ / }-->
					<!--{ / }-->
						<option value="">새 그룹 만들기</option>
					</select>
					<input type="text" name="address_group" value="" size="20" maxlength="20" />
					<div class="mt5"><label><input type="checkbox" name="save_delivery_address" value="1" /> 기본 배송지로 지정합니다.</label></div>
				</td>
			</tr>
			<tr >
				<th scope="row">설명</th>
				<td><input type="text" name="address_description" value="" size="45" /></td>
			</tr>
			<tr>
				<th scope="row">받는분</th>
				<td><input type="text" name="recipient_user_name" value="" size="20" title="받는분" /></td>
			</tr>
			<tr class="shipping_nation_tr">
				<th scope="row">국가</th>
				<td>
					<div style="float:left;padding-right:10px;" class="international_layer">
						<select name="nation_select" onchange="chg_address_nation(this);">
							<option value="KOREA">대한민국(KOREA)</option>
							<!--{ @ ship_gl_arr }-->
							<option value="{.nation_str}">{.nation_str}</option>
							<!--{ / }-->
						</select>
					</div>
				</td>
			</tr>
			<tr class="domestic">
				<th scope="row">주소</th>
				<td>
					<input type="text" name="recipient_new_zipcode" value="" size="10" title="우편번호" readonly />
					<input type="hidden" name="check_new_zipcode" value="NEW" />
					<button type="button"  class="btn_move small" onclick="window.open('../popup/zipcode?mtype=delivery','popup_zipcode','width=600,height=480')">주소찾기</button>
					<input type="hidden" name="recipient_address_type" value="" title="배송지 주소지타입(도로명/지번)" />
					<div class="mt5"><input type="text" class="address_street" name="recipient_address_street" value="" size="45" title="도로명 주소" readonly /> <span class="desc">도로명 주소</span></div>
					<div class="mt5"><input type="text" name="recipient_address" value="" size="45" title="주소" readonly /> <span class="desc">지번 주소</span></div>
					<div class="mt5"><input type="text" name="recipient_address_detail" value="" size="45" title="나머지주소" /> <span class="desc">나머지주소</span></div>
				</td>
			</tr>
			<tr class="international hide">
				<th scope="row" valign="top">주소</th>
				<td>
					<input type="text" name="international_address" value="" size="45" title="주소" /> <span class="desc">주소</span>
					<div class="mt5"><input type="text" name="international_town_city" value="" size="30" title="시도" /> <span class="desc">시도</span></div>
					<div class="mt5"><input type="text" name="international_county" value="" size="22" title="주" /> <span class="desc">주</span></div>
					<div class="mt5"><input type="text" name="international_postcode" value="" size="15" title="우편번호" /> <span class="desc">우편번호</span></div>
					<div class="hide"><input type="text" name="international_country" value="" size="30" title="국가" /> <span class="desc">국가</span></div>
				</td>
			</tr>
			<tr>
				<th scope="row">연락처</th>
				<td>
					<ul class="list_inner">
					<li class="cellphone_li">
						<input type="tel" name="recipient_cellphone[]" value="" size="3" maxlength="4" onkeydown="onlyNumber(this)" title="받는분 휴대폰"/> -
						<input type="tel" name="recipient_cellphone[]" value="" size="2" maxlength="4" onkeydown="onlyNumber(this)" /> -
						<input type="tel" name="recipient_cellphone[]" value="" size="2" maxlength="4" onkeydown="onlyNumber(this)" />
						&nbsp;
						<span class="add_phone_btn hand" id="btn_inAddress_add_phone" onclick="add_phone(this,'open');">추가연락처 ▼</span>
					</li>
					<li class="add_phone pdt5 hide">
						<input type="tel" class="add_phone_input" name="recipient_phone[]" value="" size="3" maxlength="4" onkeydown="onlyNumber(this)" /> -
						<input type="tel" class="add_phone_input" name="recipient_phone[]" value="" size="2" maxlength="4" onkeydown="onlyNumber(this)" /> -
						<input type="tel" class="add_phone_input" name="recipient_phone[]" value="" size="2" maxlength="4" onkeydown="onlyNumber(this)" />
					</li>
					</ul>
				</td>
			</tr>
		</tbody>
	</table>
	<div class="btn_wrap">
		<button type="button" id="insert_address" class="btn_chg">확인</button>
	</div>
	</form>
</div>
<!-- 배송지등록 / 수정 :: END -->

<!-- 없는 것으로 보임 -->
<!--
<div id="sales_tax_layer" class="hide"></div>
-->

<!-- 없는 것으로 보임 -->
<!--
<div id="order_return_msg" class="hide">
	교환/ 반품 신청이 접수 되었습니다.<br />
	고객센터에서 확인 후 순차적으로 처리 및<br />
	답변 또는 연락을 드리겠습니다.<br />
	<br />
	<div class="center"><span class="btn small"><input type="button" value="확인" onclick="closeDialog('order_refund_layer');document.location.reload();" /></span></div>
</div>
-->

<!-- 없는 것으로 보임 -->
<!--
<div id="order_return_coupon_msg" class="hide">
	교환/ 반품 신청이 접수 되었습니다.<br />
	고객센터에서 확인 후 순차적으로 처리 및<br />
	답변 또는 연락을 드리겠습니다.<br />
	<br />
	<div class="center"><span class="btn small"><input type="button" value="확인" onclick="closeDialog('order_return_layer');document.location.reload();" /></span></div>
</div>
-->

<!-- 없는 것으로 보임 -->
<!--
<div id="coupon_use_guide" class="hide">
	<table class="coupon_use_guide_tb" cellpadding="0" cellspacing="0" border="0">
		<tr><td>발행된 티켓은 2가지 방법으로 사용할 수 있습니다.</td></tr>
		<tr><th>1. 스마트폰 인증을 통한 사용</th></tr>
		<tr><td class="contents">가지고 있는 휴대폰을 통해 간편한 인증을 거쳐 사용할 수 있습니다.</td></tr>
		<tr><td class="list_contents">
			① 스마트폰을 통해  쇼핑몰에 접속후 my페이지>주문배송조회로 이동<br/>
			② 해당 상품의 “사용하기’ 버튼 클릭<br/>
			③ 매장 직원 인증 확인
		</td></tr>
		<tr><td class="guide_img"><img src="../images/design/guide_img_cpn.jpg" /></td></tr>
		<tr><th>2. 티켓 번호 인증을 통한 사용</th></tr>
		<tr><td class="contents">스마트폰이 없을 때는 발급받은 티켓 번호를 직접 매장 직원에게 알려줘서 사용가능합니다. 단 매장에 티켓 번호를 확인할 수 있는 인터넷 환경이 있어야 합니다.(인터넷이 연결된 PC 가 있어야 함)</td></tr>
	</table>
	<style type="text/css">
		#coupon_use_guide {display:none;padding:40px; }
		#coupon_use_guide table.coupon_use_guide_tb { width:100%; }
		#coupon_use_guide table.coupon_use_guide_tb th { text-align:left;padding-top:15px;}
		#coupon_use_guide table.coupon_use_guide_tb td { text-align:left; }
		#coupon_use_guide table.coupon_use_guide_tb td.guide_img { text-align:center; }
		#coupon_use_guide table.coupon_use_guide_tb td.contents { line-height:20px;padding:8px 15px;}
		#coupon_use_guide table.coupon_use_guide_tb td.list_contents { padding:0 15px;line-height:22px; }
	</style>
</div>
-->



